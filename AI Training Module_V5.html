<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Training for Elementary Teachers</title>
    <script src="https://cdn.tailwindcss.com" defer></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Styles remain the same as the previous version, with additions */
        body { font-family: 'Inter', sans-serif; scroll-behavior: smooth; }
        .sidebar-link.active { background-color: #e0f2fe; color: #0c4a6e; font-weight: 600; }
        #sidebar { transition: transform 0.3s ease-in-out; }
        .quiz-options::-webkit-scrollbar { display: none; }
        .quiz-options { -ms-overflow-style: none; scrollbar-width: none; }
        .feedback-correct { color: #166534; border-left: 4px solid #22c55e; padding-left: 0.75rem; margin-top: 0.5rem; background-color: #f0fdf4; padding-top: 0.5rem; padding-bottom: 0.5rem; border-radius: 0 4px 4px 0;}
        .feedback-incorrect { color: #991b1b; border-left: 4px solid #f87171; padding-left: 0.75rem; margin-top: 0.5rem; background-color: #fef2f2; padding-top: 0.5rem; padding-bottom: 0.5rem; border-radius: 0 4px 4px 0;}
        .feedback-correct .feedback-title, .feedback-incorrect .feedback-title { font-weight: 600; display: block; margin-bottom: 0.25rem; }
        .answer-correct { background-color: #dcfce7 !important; border: 1px solid #4ade80 !important; }
        .answer-incorrect { background-color: #fee2e2 !important; border: 1px solid #fca5a5 !important; }
        #certificateOutput { border: 10px solid #0ea5e9; padding: 40px; background-color: #f0f9ff; text-align: center; max-width: 800px; margin: 20px auto; }
         @media print { body * { visibility: hidden; } #certificateOutput, #certificateOutput * { visibility: visible; } #certificateOutput { position: absolute; left: 0; top: 0; width: 100%; margin: 0; padding: 20px; border: 5px solid #0ea5e9 !important; box-shadow: none; } .no-print { display: none !important; } }
         .prompt-comparison { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
         .prompt-box { border: 1px solid #ccc; padding: 1rem; border-radius: 0.375rem; height: 100%; display: flex; flex-direction: column;}
         .prompt-box h4 { font-weight: 600; margin-bottom: 0.5rem; } .prompt-box p.italic { flex-grow: 1; }
         .prompt-weak { border-left: 4px solid #f87171; background-color: #fef2f2; } .prompt-strong { border-left: 4px solid #4ade80; background-color: #f0fdf4; }
         @media (max-width: 768px) { .prompt-comparison { grid-template-columns: 1fr; } }
         .sim-prompt-box { background-color: #f3f4f6; border: 1px solid #d1d5db; border-radius: 0.375rem; padding: 1rem; margin-bottom: 0.75rem; }
         .sim-prompt-box code { font-family: monospace; background-color: #e5e7eb; padding: 0.1rem 0.3rem; border-radius: 0.25rem; font-size: 0.9em; }
         .sim-submit-btn { background-color: #3b82f6; color: white; padding: 0.5rem 1rem; border-radius: 0.375rem; transition: background-color 0.2s; font-weight: 500; cursor: pointer; }
         .sim-submit-btn:hover { background-color: #2563eb; }
         .sim-response-box { background-color: #f0f9ff; border: 1px dashed #7dd3fc; border-radius: 0.375rem; padding: 1rem; margin-top: 1rem; font-size: 0.9rem; color: #0c4a6e; transition: opacity 0.5s ease-in-out, max-height 0.5s ease-in-out; opacity: 0; max-height: 0; overflow: hidden; }
         .sim-response-box.visible { opacity: 1; max-height: 500px; }
        .benefit-challenge-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; }
        .benefit-box, .challenge-box { padding: 1rem; border-radius: 0.5rem; }
        .benefit-box { background-color: #f0fdf4; border: 1px solid #bbf7d0; } .challenge-box { background-color: #fffbeb; border: 1px solid #fde68a; }
        .benefit-box h4 { color: #15803d; font-weight: 600; margin-bottom: 0.5rem; } .challenge-box h4 { color: #b45309; font-weight: 600; margin-bottom: 0.5rem; }
        .benefit-box ul, .challenge-box ul { list-style: none; padding-left: 0; }
        .benefit-box li::before { content: "‚úÖ"; margin-right: 0.5rem; } .challenge-box li::before { content: "‚ö†Ô∏è"; margin-right: 0.5rem; }
        @media (max-width: 768px) { .benefit-challenge-grid { grid-template-columns: 1fr; } }
         .safety-checklist li { padding: 0.5rem 0; border-bottom: 1px dashed #e5e7eb; } .safety-checklist li:last-child { border-bottom: none; }
         .safety-checklist i { margin-right: 0.75rem; width: 1.25rem; text-align: center; }
         .text-red-shield { color: #ef4444; } .text-blue-check { color: #3b82f6; } .text-yellow-info { color: #f59e0b; } .text-purple-eye { color: #8b5cf6; } .text-gray-policy { color: #6b7280; } .text-cyan-600 { color: #0891b2; }
         .getting-started-steps { counter-reset: step-counter; }
         .getting-started-steps li { counter-increment: step-counter; margin-bottom: 1rem; padding-left: 2.5rem; position: relative; }
         .getting-started-steps li::before { content: counter(step-counter); position: absolute; left: 0; top: 0; width: 1.75rem; height: 1.75rem; background-color: #38bdf8; color: white; font-weight: bold; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.9rem; }
         .summary-points li { padding-left: 1.5rem; position: relative; margin-bottom: 0.75rem; }
         .summary-points li::before { content: "üéØ"; position: absolute; left: 0; top: 1px; }
        .key-term { font-weight: 600; color: #0369a1; }
        .flip-card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem; margin-top: 1rem; margin-bottom: 1rem; }
        .flip-card { background-color: transparent; width: 100%; aspect-ratio: 3 / 2; perspective: 1000px; }
        .flip-card-inner { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.6s; transform-style: preserve-3d; box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2); border-radius: 0.5rem; }
        .flip-card:hover .flip-card-inner, .flip-card:focus-within .flip-card-inner { transform: rotateY(180deg); }
        .flip-card-front, .flip-card-back { position: absolute; width: 100%; height: 100%; -webkit-backface-visibility: hidden; backface-visibility: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 1rem; border-radius: 0.5rem; }
        .flip-card-front { background-color: #ecfdf5; color: #065f46; border: 1px solid #a7f3d0; }
        .flip-card-front h4 { font-weight: 600; font-size: 1.1rem; margin-bottom: 0.5rem; }
         @media (max-width: 639px) { .flip-card-front h4 { font-size: 1rem; } }
        .flip-card-front p { font-size: 0.8rem; color: #047857; }
        .flip-card-back { background-color: #f0f9ff; color: #075985; border: 1px solid #bae6fd; transform: rotateY(180deg); font-size: 0.9rem; overflow-y: auto; }
        .flip-card-back h5 { font-weight: 600; margin-bottom: 0.5rem; }
        .flip-card-container { display: inline-block; } .flip-card-container:focus { outline: 2px solid #38bdf8; outline-offset: 2px; border-radius: 0.5rem; }
        .reveal-container summary { cursor: pointer; list-style: none; /* Ensure default marker is hidden */ }
        .reveal-container summary::-webkit-details-marker { display: none; } /* Hide marker in Webkit */
        .reveal-container summary::before { content: '‚ñ∂'; display: inline-block; margin-right: 0.5rem; transition: transform 0.2s ease-in-out; font-size: 0.8em; color: #64748b; }
        .reveal-container details[open] summary::before { transform: rotate(90deg); }
        .reveal-container .reveal-content { padding: 0 1rem 1rem 1rem; color: #334155; font-size: 0.9rem; border-top: 1px dashed #e2e8f0; margin-top: 0.5rem; padding-top: 0.75rem; }
        .matching-item { display: flex; align-items: center; margin-bottom: 0.75rem; gap: 1rem; }
        .matching-term { flex-basis: 40%; font-weight: 500; }
        .matching-select { flex-grow: 1; padding: 0.5rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: white; cursor: pointer; }
        .matching-select:disabled { background-color: #f3f4f6; cursor: not-allowed; opacity: 0.7; }
        .matching-select.answer-correct { border-color: #4ade80 !important; background-color: #dcfce7 !important; }
        .matching-select.answer-incorrect { border-color: #fca5a5 !important; background-color: #fee2e2 !important; }

        /* --- Timeline Styles --- */
        .timeline-container-enhanced { position: relative; padding: 2rem 0; }
        .timeline-line { position: absolute; left: 0; right: 0; top: 50%; height: 4px; background-color: #94a3b8; transform: translateY(-50%); z-index: 1; }
        .timeline-items-wrapper { position: relative; z-index: 2; overflow-x: auto; padding-bottom: 1rem; }
        /* Added swipe hint styles */
        .timeline-items-wrapper.needs-swipe-hint::after {
            content: '‚ÜîÔ∏è Swipe'; /* Or use an icon font: '\f35a' for fas fa-arrows-left-right */
            /* font-family: "Font Awesome 6 Free"; font-weight: 900; */
            position: absolute;
            bottom: -0.5rem; /* Adjust position */
            right: 1rem;
            font-size: 0.75rem;
            color: #64748b; /* slate-500 */
            background-color: #e2e8f0; /* slate-200 */
            padding: 0.1rem 0.4rem;
            border-radius: 0.25rem;
            opacity: 0;
            animation: swipeHint 3s 1s ease-in-out forwards; /* Delay start */
        }
        @keyframes swipeHint {
            0% { opacity: 0; transform: translateX(0); }
            20% { opacity: 1; transform: translateX(-10px); }
            40% { opacity: 1; transform: translateX(10px); }
            60% { opacity: 1; transform: translateX(-10px); }
            80% { opacity: 1; transform: translateX(0); }
            100% { opacity: 0; transform: translateX(0); }
        }
        /* Only show hint on smaller screens where scrolling is likely */
        @media (min-width: 768px) { /* md breakpoint */
            .timeline-items-wrapper.needs-swipe-hint::after {
                display: none;
            }
        }
        .timeline-items { display: inline-flex; align-items: flex-start; min-width: 100%; padding: 0 2rem; }
        .timeline-item { position: relative; display: flex; flex-direction: column; align-items: center; margin: 0 2rem; padding-top: 1.5rem; cursor: pointer; min-width: 100px; text-align: center; transition: opacity 0.2s ease; }
        .timeline-item:hover { opacity: 0.8; }
        .timeline-item::before { content: ''; position: absolute; bottom: calc(50% - 0.75rem); left: 50%; transform: translateX(-50%); width: 2px; height: 1.5rem; background-color: #94a3b8; z-index: 1; }
        .timeline-point-enhanced { position: relative; width: 1rem; height: 1rem; background-color: #e2e8f0; border: 2px solid #94a3b8; border-radius: 50%; z-index: 3; transition: transform 0.2s ease, background-color 0.2s ease, border-color 0.2s ease; margin-bottom: 0.5rem; }
        .timeline-item:hover .timeline-point-enhanced { transform: scale(1.3); background-color: #60a5fa; }
        .timeline-item.active .timeline-point-enhanced { background-color: #2563eb; border-color: #1d4ed8; transform: scale(1.3); }
        .timeline-item.active .timeline-label { font-weight: 700; color: #2563eb; }
        .timeline-label { font-size: 0.875rem; color: #475569; transition: color 0.2s ease, font-weight 0.2s ease; }
        .details-section { background-color: #f1f5f9; border: 1px solid #e2e8f0; border-radius: 0.5rem; padding: 1rem; margin-top: 1rem; min-height: 150px; transition: all 0.3s ease-in-out; }
        .details-section h3 { color: #1e3a8a; }
        .details-section p { color: #334155; }
        .milestones-list { list-style: none; padding-left: 0; }
        .milestones-list li { margin-bottom: 0.25rem; display: flex; align-items: center; }
        .milestones-list i { margin-right: 0.5rem; color: #64748b; font-size: 0.8rem; }
        .factoid { background-color: #e0f2fe; border-left: 4px solid #0ea5e9; padding: 0.75rem; margin-top: 1rem; font-style: italic; color: #0369a1; border-radius: 0 0.375rem 0.375rem 0; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* --- Next Button Highlight Animation --- */
        @keyframes pulse-border {
            0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.5); } /* sky-500 */
            70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
            100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
        }
        .highlight-next {
            animation: pulse-border 1.5s infinite;
            border: 2px solid #3b82f6; /* Add border for pulse effect */
        }

        /* --- Audio Player Button --- */
        .audio-player-btn {
            background-color: #f0f9ff; /* sky-50 */
            color: #0369a1; /* sky-700 */
            border: 1px solid #bae6fd; /* sky-200 */
            padding: 0.3rem 0.6rem;
            border-radius: 0.375rem; /* rounded-md */
            font-size: 0.8rem;
            cursor: pointer;
            transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
            float: right;
            margin-left: 1rem;
            margin-bottom: 0.5rem;
        }
        .audio-player-btn:hover {
            background-color: #e0f2fe; /* sky-100 */
        }
        .audio-player-btn.playing { /* State when actively playing */
            background-color: #fef9c3; /* yellow-100 */
            color: #a16207; /* yellow-700 */
            border-color: #fde047; /* yellow-300 */
        }
         .audio-player-btn.paused { /* State when paused */
            background-color: #fed7aa; /* orange-200 */
            color: #9a3412; /* orange-800 */
            border-color: #fed7aa; /* orange-200 */
        }
        #sectionAudioPlayer { display: none; }

    </style>
</head>
<body class="bg-gray-100">
    <audio id="sectionAudioPlayer"></audio>

    <div class="flex h-screen overflow-hidden">
        <aside id="sidebar" class="fixed inset-y-0 left-0 z-30 w-64 bg-white shadow-lg transform -translate-x-full md:relative md:translate-x-0 flex flex-col no-print">
             <div class="flex items-center justify-between p-4 border-b"> <h1 class="text-xl font-semibold text-gray-800">AI Training</h1> <button id="closeSidebarBtn" class="text-gray-600 md:hidden"> <i class="fas fa-times text-xl"></i> </button> </div>
             <nav class="flex-1 overflow-y-auto p-4 space-y-2">
                <a href="#" data-section="1" class="sidebar-link block px-4 py-2 text-gray-700 rounded-md hover:bg-gray-100" aria-current="page">1. Welcome!</a>
                <a href="#" data-section="2" class="sidebar-link block px-4 py-2 text-gray-700 rounded-md hover:bg-gray-100">2. What is AI?</a>
                <a href="#" data-section="3" class="sidebar-link block px-4 py-2 text-gray-700 rounded-md hover:bg-gray-100">3. AI Through Time</a>
                <a href="#" data-section="4" class="sidebar-link block px-4 py-2 text-gray-700 rounded-md hover:bg-gray-100">4. How AI Learns</a>
                <a href="#" data-section="5" class="sidebar-link block px-4 py-2 text-gray-700 rounded-md hover:bg-gray-100">5. Talking to AI: Prompting</a>
                <a href="#" data-section="6" class="sidebar-link block px-4 py-2 text-gray-700 rounded-md hover:bg-gray-100">6. Your AI Toolkit</a>
                <a href="#" data-section="7" class="sidebar-link block px-4 py-2 text-gray-700 rounded-md hover:bg-gray-100">7. AI in Your Workflow</a>
                <a href="#" data-section="8" class="sidebar-link block px-4 py-2 text-gray-700 rounded-md hover:bg-gray-100">8. Benefits & Challenges</a>
                <a href="#" data-section="9" class="sidebar-link block px-4 py-2 text-gray-700 rounded-md hover:bg-gray-100">9. Playing it Safe</a>
                <a href="#" data-section="10" class="sidebar-link block px-4 py-2 text-gray-700 rounded-md hover:bg-gray-100">10. Getting Started</a>
                <a href="#" data-section="11" class="sidebar-link block px-4 py-2 text-gray-700 rounded-md hover:bg-gray-100">11. Wrap-up & Next Steps</a>
                <a href="#" data-section="final-quiz" class="sidebar-link block px-4 py-2 text-gray-700 rounded-md hover:bg-gray-100 font-medium">Final Quiz</a>
                <a href="#" data-section="certificate" class="sidebar-link block px-4 py-2 text-gray-700 rounded-md hover:bg-gray-100 font-medium">Certificate</a>
            </nav>
             <div class="p-4 border-t"> <button id="resetModuleBtn" class="w-full px-4 py-2 text-sm text-center text-white bg-red-500 rounded-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-opacity-50"> Reset Module </button> </div>
        </aside>

        <div class="flex-1 flex flex-col overflow-hidden">
             <header class="bg-white shadow-sm border-b no-print"> <div class="flex items-center justify-between p-4"> <button id="openSidebarBtn" class="text-gray-600 focus:outline-none md:hidden"> <i class="fas fa-bars text-xl"></i> </button> <h2 id="sectionTitle" class="text-xl font-semibold text-gray-800 flex-1 text-center md:text-left ml-4 md:ml-0"> Loading... </h2> </div> </header> <main id="contentArea" class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-6 space-y-6"> <div class="bg-white p-8 rounded-lg shadow space-y-6"> <p>Loading content...</p> </div> </main> <footer class="bg-white p-4 border-t no-print"> <div class="flex justify-between"> <button id="prevBtn" class="px-6 py-2 text-white bg-sky-500 rounded-md hover:bg-sky-600 disabled:opacity-50 disabled:cursor-not-allowed"> <i class="fas fa-arrow-left mr-2"></i> Previous </button> <button id="nextBtn" class="px-6 py-2 text-white bg-sky-500 rounded-md hover:bg-sky-600 disabled:opacity-50 disabled:cursor-not-allowed border-2 border-transparent"> Next <i class="fas fa-arrow-right ml-2"></i> </button> </div> </footer>
        </div>
    </div>

    <div id="quizModal" class="fixed inset-0 z-40 bg-gray-800 bg-opacity-75 flex items-center justify-center hidden p-4 no-print"> <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col"> <div class="p-4 border-b flex justify-between items-center"> <h3 id="quizTitle" class="text-lg font-semibold">Section Quiz</h3> </div> <div id="quizContent" class="p-6 overflow-y-auto quiz-options space-y-4"> </div> <div class="p-4 border-t bg-gray-50 flex justify-end space-x-3"> <button id="resetQuizBtn" class="px-4 py-2 text-sm text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300">Reset Quiz</button> <button id="submitQuizBtn" class="px-4 py-2 text-sm text-white bg-sky-500 rounded-md hover:bg-sky-600">Submit Answers</button> <button id="closeQuizBtn" class="px-4 py-2 text-sm text-white bg-sky-500 rounded-md hover:bg-sky-600 hidden">Close Quiz</button> </div> </div> </div>


    <script>
        // --- Constants and State ---
        const sections = [
             { id: 1, title: "Welcome!", quiz: false }, { id: 2, title: "What is AI?", quiz: true }, { id: 3, title: "AI Through Time", quiz: true }, { id: 4, title: "How AI Learns", quiz: true }, { id: 5, title: "Talking to AI: Prompting", quiz: true }, { id: 6, title: "Your AI Toolkit", quiz: true }, { id: 7, title: "AI in Your Workflow", quiz: true }, { id: 8, title: "Benefits & Challenges", quiz: true }, { id: 9, title: "Playing it Safe", quiz: true }, { id: 10, title: "Getting Started", quiz: true }, { id: 11, title: "Wrap-up & Next Steps", quiz: false }, { id: 'final-quiz', title: "Final Quiz", quiz: false }, { id: 'certificate', title: "Certificate of Completion", quiz: false }
        ];

        // --- Audio File Mapping ---
        const sectionAudio = {
            1: "https://pouch.jumpshare.com/preview/o5zZa5de-dg9GkrKxs711OjFjqItzN2qqT4EAaWSySnoDUMV_L7g8Vm9ytraw5kKHIp5j72rKBk2aslETGxxTVN-NKIA9BoXQGcci4PTTDlXUMSkNxXLMFKbzKTNNAGpM_ofp4KwSx-JNCnBYYFzSm6yjbN-I2pg_cnoHs_AmgI.mp3",
            2: "https://pouch.jumpshare.com/preview/eM5Iw-w1Dj4-jyk_2wfHEAHP1JDl-QUSeL0YDsP0YIWoWLC3e-bS5DgJ7Uxp4KhSCo3tQljVX5csy3PdUAiLDjBwWt1biFZlqqC0JDUwwANdoLu9p_zv0F2wMDuJ99QpOG3Sf_MWfXVfhqLXUU_LbG6yjbN-I2pg_cnoHs_AmgI.mp3",
            3: "https://pouch.jumpshare.com/preview/XIHb9N-TOjJ4rEA-oAHkC9pSpCWtBeuf2LUP6g2kTsvY_ZvwPo-8k6NIJvYWibTwPbdAmjrEzAE7BtrylTTGVSBXBtdAlgyhbZcJHVqhuiwEet1gSMxKlL14uIC-BlsgNqzz2ePbxdYPMjMt0J4lAG6yjbN-I2pg_cnoHs_AmgI.mp3",
            4: "https://pouch.jumpshare.com/preview/NhBzQoul_1wQs7A-m5R9U5dTEjijnHI5BYMSBA0qaMBG46IulLDIyegY4ovXuOWoWMvbIOdX-kNw3dk9t_Jq4OPm9rcdiCo3J535N_J2fHEvaxFM0KJeBN_r9OUZ6p3WRPaPbRC0Ds4P7sFW5BIEPG6yjbN-I2pg_cnoHs_AmgI.mp3",
            5: "https://pouch.jumpshare.com/preview/o_8UgzA4AyRsr2dAf64NLLWCpUt42jd7A7uLDgH1dvE-Dhk5GuWKCcqOq9n4zRZp9uiH7m0sOqhE7wQkwUq8Ckxp6hTTEuW3oTbQhEjQMqeQHhgVKeVOAcz61j7r9OUUop5OmNdkHcaOqAXtlByB926yjbN-I2pg_cnoHs_AmgI.mp3",
            6: "https://pouch.jumpshare.com/preview/2CnhCeT9PGX5P-ncx5k2aOf1bipg1N32QFh-mXjXk0VqH0sPlQoqBb-4AR2-gcC2uSjD2Y-ZZ1j-FEBTRIyW2TIvgnT3hEfpr4dBEezK3vt2aF5GdIKBX-Ozzl_UgiPyeNEQm_6tZkKYrGLSIr8H526yjbN-I2pg_cnoHs_AmgI.mp3",
            7: "https://pouch.jumpshare.com/preview/8Z4eEC6FL8WauieSTFOQmuHgeNsQ55Z8Yc13fTswzHEOlP5N6syB5lSt61Nbd8rbgeJSrscUxFSRcdb_z3TTz_FUCDxY7-NuLD5JyFsftMiSc4FRHoViBZUuQr7c-Edq9LcKNDP2rGfXKQnloFcJLm6yjbN-I2pg_cnoHs_AmgI.mp3",
            8: "https://pouch.jumpshare.com/preview/zzPGtqCjmfvP8QVwKjviIAlTtPw31eEMKzuhiO18hNvszW9N5-ROEgVdFWbQmvwr8LhUB4lsUvFgCi9nnbP9G5aALEaAsMvEOjc4JEVAZWKqm-NFkUqKI6yu2bHc-bc3MRgS5YVyC4lPc5GMh9DsGG6yjbN-I2pg_cnoHs_AmgI.mp3",
            9: "https://pouch.jumpshare.com/preview/v4L5Ox74-y3ew9QyMWRE18BtGm-4zTe2NxXvBc8iOz1xsl6R2Ce6Q89TdkBvDjMiHM0Qwvz8C-6utuNOkjsxn14IlbxeMt26OWH1b7a1sbzkn7USCZ094v05zeLb4EOsJA28psViu8JcHWYLyufne26yjbN-I2pg_cnoHs_AmgI.mp3",
            10: "https://pouch.jumpshare.com/preview/zhG19FjxaXVP3UejdJhYWcAdY8uOLCyUklsZOAjJHu6ZTjRbZH7VyFviFASmsW-6NF-sA3Sn_5f3t6N3i32iAzWtb7NDU9j3BgDT54eDzcnFUpEcDNGf5YGqnJwXkuAuZF4MQwrS_363JLZvRfSnpm6yjbN-I2pg_cnoHs_AmgI.mp3",
            11: "https://pouch.jumpshare.com/preview/n1fX8klccHXg4AFinwAzCRWursnZ8t2fu2P_gmT9poOMiv1ThQZ_X0gy3HL6sYp0ICzZkRyZ74KmDxHZsdHKJZZIvnbk3GGBg-rt2Sv9XuzCf1s0YmoTj8rIjRcBM8Y4gNcJehZS4kHZavzwjMtWBG6yjbN-I2pg_cnoHs_AmgI.mp3"
        };

        // --- Quiz Data ---
        const quizzes = {
            2: [ { q: "Which statement best describes the main goal of this training module?", type: 'mc', options: ["To make you an expert AI coder", "To help you understand AI basics and use it safely as a teaching tool", "To show how AI will replace classroom teachers", "To focus only on the history of AI development"], answer: 1, feedback: ["Not quite. This module focuses on using AI tools, not programming them.", "Correct! We aim to build foundational knowledge and confidence in using AI responsibly in your teaching practice.", "That's not the goal. AI is presented here as a supportive tool for educators, not a replacement.", "While we touch on history, the main focus is on practical understanding and application for teachers."] }, { q: "True or False: The AI discussed in this module (like chatbots or image generators) is considered 'Narrow AI', meaning it's designed for specific tasks.", type: 'tf', answer: true, correctFeedback: "Correct! Most AI tools we use today are Narrow AI, excelling at specific functions like language translation or generating text, rather than possessing general human-like intelligence.", incorrectFeedback: "Good try! Actually, the AI tools commonly available today are 'Narrow AI'. They are very good at specific tasks but don't have the broad, adaptable intelligence of humans (which would be 'General AI')." } ],
            3: [ { q: "Which of these is an example of AI you might use daily?", type: 'mc', options: ["A standard calculator", "A streaming service movie recommendation", "A light switch", "A printed map"], answer: 1, feedback: ["Not quite. A standard calculator performs predefined operations without learning.", "Correct! Recommendation systems use AI to learn your preferences and suggest relevant content.", "A simple light switch is manually operated.", "A printed map is static information."] }, { q: "Select the option that places these AI milestones in the correct chronological order (earliest to most recent):", type: 'ordering_mc', options: [ "A) Generative Boom -> Rise of Machine Learning -> Foundational Ideas", "B) Foundational Ideas -> Rise of Machine Learning -> Generative Boom", "C) Rise of Machine Learning -> Foundational Ideas -> Generative Boom", "D) Generative Boom -> Foundational Ideas -> Rise of Machine Learning" ], answer: 1, feedback: [ "Not quite. Think about which concepts had to come first before machine learning could take off.", "Correct! The foundational concepts came first (1950s), followed by the development of machine learning (80s-00s), and then the recent boom in powerful generative models (2010s+).", "Almost! Machine learning built upon the earlier foundational ideas.", "Consider the timeline ‚Äì generative models are the most recent major development shown here." ] } ],
            4: [ { q: "Match the AI learning concepts (from our baking analogy) to their descriptions:", type: 'matching', items: [ { id: 'data', term: "Data" }, { id: 'algo', term: "Algorithm" }, { id: 'learn', term: "Learning Process" } ], options: [ { id: 'desc1', text: "The step-by-step instructions or 'recipe' the AI follows." }, { id: 'desc2', text: "The vast amount of information or 'ingredients' the AI trains on." }, { id: 'desc3', text: "The process of adjusting internal settings based on patterns found in examples." } ], answer: { 'data': 'desc2', 'algo': 'desc1', 'learn': 'desc3' }, correctFeedback: "Excellent! You've correctly matched the core concepts of AI learning.", incorrectFeedback: "Not quite right. Review the analogies: Data is the ingredients, Algorithms are the recipe, and Learning is the process of refining based on tasting/examples." }, { q: "What is the core process AI uses to 'learn' from data?", type: 'mc', options: ["Developing emotions", "Memorizing every single data point", "Recognizing patterns and relationships", "Randomly guessing answers"], answer: 2, feedback: ["Current AI doesn't develop emotions or consciousness; its learning is mathematical.", "While AI processes vast data, its strength lies in identifying patterns, not just memorizing individual pieces of information.", "Correct! AI learning is essentially sophisticated pattern recognition ‚Äì finding connections and correlations within the data it's trained on.", "AI uses algorithms, not random guessing, to find patterns and make predictions based on data."] }, { q: "True or False: An AI needs to 'understand' a concept like a human does to generate text about it.", type: 'tf', answer: false, correctFeedback: "Correct! AI operates on patterns in language and data. It can generate grammatically correct and contextually relevant text about topics without having true comprehension or consciousness.", incorrectFeedback: "That's a common misconception! AI excels at pattern matching in language. It can write about photosynthesis without actually 'understanding' biology like a person does." } ],
            5: [ { q: "To get the most helpful response from an AI assistant for a classroom task, your prompt should ideally be:", type: 'mc', options: ["Very short and open-ended", "Filled with complex academic jargon", "Clear, specific, and provide context (like grade level)", "Written entirely in questions"], answer: 2, feedback: ["While sometimes useful for broad brainstorming, very short prompts often lead to generic results for specific tasks.", "Using overly complex language might confuse the AI or lead to outputs that aren't practical. Clear, simple language is usually better.", "Correct! Providing clarity (what you want), specificity (details), and context (audience, subject) helps the AI generate a much more targeted and useful response.", "While questions can be part of a prompt, commands (like 'Generate,' 'List,' 'Explain') combined with context are often more effective."] }, { q: "If your first prompt doesn't give the desired result, what's a good next step?", type: 'mc', options: ["Assume the AI tool is broken", "Give up on using AI for that task", "Rephrase the prompt, adding more detail or changing the perspective", "Ask the AI why it gave a bad answer"], answer: 2, feedback: ["It's unlikely the tool is completely broken. The issue is often the prompt itself.", "Don't give up easily! Prompting is often an iterative process.", "Correct! Refining your prompt is key. Try adding more context, being more specific, asking for a different format, or even telling the AI what *not* to include.", "While you can sometimes ask for clarification, actively refining your own prompt based on the output is usually more productive."] }, { q: "Telling the AI to respond 'as a helpful librarian' or 'in the style of a pirate' is an example of specifying what element in a prompt?", type: 'mc', options: ["The Goal", "The Format", "The Persona or Role", "The Data Source"], answer: 2, feedback: ["The goal is *what* you want (e.g., list books), not *how* the AI should act.", "The format is the structure (e.g., bullet points), not the AI's character.", "Correct! Assigning a persona or role can influence the tone, style, and sometimes even the content of the AI's response.", "The data source is what the AI learned from, not an instruction you typically give in a prompt."] } ],
            6: [ { q: "A teacher uses an AI tool to generate different opening hooks for a lesson on fractions. Which category does this primarily fall into?", type: 'mc', options: ["Accessibility Tools", "Assessment & Feedback Aids", "Content Creation Aids", "Idea Generation / Brainstorming"], answer: 3, feedback: ["Accessibility tools usually focus on overcoming barriers like reading difficulties.", "Assessment tools help evaluate learning, not typically generate initial lesson ideas.", "While it involves creating content, the main purpose here is exploring different creative starting points.", "Correct! Using AI to come up with various creative options or starting points for a lesson is a great example of idea generation."] }, { q: "Why is it important to check the privacy policy of an AI tool before using it for school-related tasks?", type: 'mc', options: ["To see if it offers discounts for teachers", "To understand how it handles user data and ensure compliance with school policies", "To find out who programmed the AI", "To learn advanced prompting techniques"], answer: 1, feedback: ["Discounts are nice, but privacy is the critical factor here.", "Correct! Privacy policies explain how your data (and potentially student data, if applicable and allowed) is collected, used, and protected. This is crucial for meeting ethical and legal obligations.", "The programmers' identities aren't usually relevant to safe use.", "Prompting techniques are learned through practice and resources, not typically detailed in privacy policies."] }, { q: "True or False: All AI tools within the same category (e.g., Content Creation) work exactly the same way and produce identical results.", type: 'tf', answer: false, correctFeedback: "Correct! Different AI models and tools, even within the same category, have unique strengths, weaknesses, training data, and interfaces. Results can vary significantly.", incorrectFeedback: "Not quite. Even tools designed for similar tasks can differ greatly in their capabilities, the quality of their output, and how they respond to prompts. It's often worth trying a couple of options if one isn't working well." } ],
            7: [ { q: "A teacher asks an AI: 'Create a simple social story for a 1st grader about sharing toys, focusing on taking turns.' This is a practical example of using AI for:", type: 'mc', options: ["Generating Math Problems", "Creating Specific Learning Supports", "Summarizing Research Articles", "Translating Parent Letters"], answer: 1, feedback: ["This prompt is focused on social-emotional learning, not math.", "Correct! This demonstrates using AI to create tailored content that supports specific student needs, like social skills development.", "Summarization involves condensing existing text, not creating a new story.", "Translation changes language; this prompt asks for original content creation."] }, { q: "What is the crucial step a teacher MUST take after using AI to draft differentiated questions or a newsletter snippet?", type: 'mc', options: ["Immediately delete the AI output", "Send it directly to students or parents", "Carefully review, edit, and personalize the content", "Ask the AI to grade its own work"], answer: 2, feedback: ["Deleting it might be wasteful if it's a useful starting point.", "Sending unreviewed AI content is risky due to potential errors, biases, or inappropriate tone.", "Correct! Human oversight is essential. Always review for accuracy, appropriateness, tone, and add your own professional touch before using or sharing AI-generated content.", "AI cannot reliably evaluate the pedagogical appropriateness or contextual nuances of its own work."] }, { q: "True or False: The examples in this section show that AI can completely replace the need for teacher planning and material creation.", type: 'tf', answer: false, correctFeedback: "Correct! The examples illustrate how AI can *assist* with these tasks, acting as a helpful starting point or efficiency tool, but the teacher's expertise in refining, selecting, and implementing materials remains crucial.", incorrectFeedback: "Good try, but the examples are meant to show AI as an *assistant*. It can speed things up or provide ideas, but it doesn't replace the teacher's judgment, creativity, and understanding of their students." } ],
            8: [ { q: "Saving time on drafting initial lesson ideas allows teachers more time for direct student interaction. This highlights which aspect of AI use?", type: 'mc', options: ["A potential challenge (Over-Reliance)", "A potential benefit (Efficiency Boost)", "A data privacy risk", "An example of AI bias"], answer: 1, feedback: ["While over-reliance is a challenge, this specific outcome describes a positive aspect.", "Correct! One of the key potential benefits of AI is increasing efficiency in certain tasks, freeing up educators for other important activities like working directly with students.", "Data privacy is a separate, important concern, but not what this scenario describes.", "AI bias relates to unfair or stereotypical outputs, not time savings."] }, { q: "An AI tool trained primarily on historical texts might generate content reflecting outdated social norms. This is an example of which challenge?", type: 'mc', options: ["Accuracy Issues ('Hallucinations')", "Potential Bias", "Digital Divide", "Over-Reliance"], answer: 1, feedback: ["Hallucinations are typically factually incorrect or nonsensical outputs, whereas this relates to skewed perspectives.", "Correct! AI learns from its training data, and if that data contains historical or societal biases, the AI's output may perpetuate them. This requires careful review by the educator.", "The digital divide relates to unequal access to technology, not the content itself.", "Over-reliance is about depending too much on the tool, not the nature of its potentially flawed output."] }, { q: "True or False: Because AI can generate information quickly, teachers no longer need to focus on developing students' critical thinking skills.", type: 'tf', answer: false, correctFeedback: "Correct! If anything, the presence of AI makes critical thinking *more* important. Students (and teachers) need to evaluate AI-generated information, identify potential issues, and think critically about its use.", incorrectFeedback: "Not at all! The ease with which AI generates information makes critical evaluation skills even more vital. We need to teach students (and practice ourselves) how to question, verify, and thoughtfully use AI outputs." } ],
            9: [ { q: "Which action is essential for protecting student privacy when using a public AI tool for brainstorming classroom scenarios?", type: 'mc', options: ["Using student first names only", "Describing students using anonymized details (e.g., 'a student struggling with fractions')", "Getting verbal permission from the student", "Using the tool only outside of school hours"], answer: 1, feedback: ["Even first names can be identifying, especially in context. Avoid using real names.", "Correct! Using general, anonymized descriptions allows you to get help with scenarios without compromising the privacy of specific students.", "Verbal permission isn't sufficient for data privacy regulations like FERPA/COPPA, especially with third-party tools. Stick to anonymization and approved tools.", "The time of day doesn't change the privacy implications of the data entered."] }, { q: "Why is 'Human Oversight' a key principle for responsible AI use by teachers?", type: 'mc', options: ["Because AI tools often crash", "Because teachers need to check if the AI followed the prompt exactly", "Because AI lacks real-world understanding, common sense, and ethical judgment", "Because schools require teachers to log all AI use"], answer: 2, feedback: ["While tools can have glitches, the core reason for oversight is about content quality and ethics.", "Following the prompt is only part of it. The output still needs evaluation for accuracy, bias, and appropriateness.", "Correct! AI operates based on patterns, not true understanding. Teachers must apply their professional judgment, contextual knowledge, and ethical considerations to review and approve AI outputs.", "Logging AI use might be a local policy, but the fundamental reason for oversight is ensuring the quality and safety of what the AI produces."] }, { q: "True or False: It is generally acceptable to copy educational materials directly from an AI tool and present them as your own original work.", type: 'tf', answer: false, correctFeedback: "Correct! Transparency and academic integrity are important. While AI can assist, educators should acknowledge its use appropriately and avoid presenting AI-generated text verbatim as their own creation.", incorrectFeedback: "Not quite. Ethical use includes being transparent about using AI assistance. Presenting significant AI-generated content as entirely your own work can be misleading or violate academic integrity principles." } ],
            10: [ { q: "According to this section, what is a good 'first step' task for a teacher new to using AI?", type: 'mc', options: ["Automating all parent communication", "Generating ideas for a classroom bulletin board", "Using AI to write substitute teacher plans", "Creating final exam questions"], answer: 1, feedback: ["Automating all communication is too high-stakes for a first step.", "Correct! Brainstorming creative, low-stakes ideas like this is a perfect way to experiment safely and see what the AI can do.", "Substitute plans are critical and require careful, verified information ‚Äì not ideal for a first try.", "Final exam questions are high-stakes and require careful validation, making them unsuitable for initial experimentation."] }, { q: "What does it mean to focus on 'augmentation' rather than 'replacement' when using AI?", type: 'mc', options: ["Using AI only for tasks students dislike", "Letting AI do most of the teaching", "Using AI as a tool to help and enhance your teaching, not take it over", "Replacing textbooks with AI chatbots"], answer: 2, feedback: ["The focus should be on tasks where AI can genuinely assist the teacher, regardless of student preference.", "Augmentation means AI supports the teacher, who remains central to the teaching process.", "Correct! Augmentation emphasizes using AI as a helpful assistant to improve efficiency or spark ideas, while the teacher retains control and the core human elements of teaching.", "Replacing resources is a different consideration; augmentation is about how the teacher uses the tool in their practice."] }, { q: "True or False: Once you find one AI tool you like, you should stop looking for new resources or learning about AI.", type: 'tf', answer: false, correctFeedback: "Correct! AI is constantly changing. Staying curious, exploring new tools (when appropriate and policy-aligned), and engaging in ongoing professional learning is important for using AI effectively long-term.", incorrectFeedback: "Good try, but because AI evolves so quickly, it's beneficial to stay informed about new developments, tools, and best practices through reliable resources and collaboration with colleagues." } ],
            'final-quiz': [
                 { q: "What does AI primarily learn from?", type: 'mc', options: ["Magic", "Data", "Electricity", "Books"], answer: 1, feedback: ["While AI can seem magical, it's based on computation.", "Correct! AI systems learn by analyzing patterns and relationships within large datasets.", "Electricity powers the hardware, but the learning comes from the information processed.", "Books can be a source of data, but AI learns from the processed data itself, in various forms."], sectionLink: 4 }, { q: "True or False: For best results, AI prompts should always be as short and vague as possible.", type: 'tf', answer: false, correctFeedback: "Correct! Effective prompts are typically clear, specific, and provide context (like audience or goal) to help the AI generate a relevant and useful response.", incorrectFeedback: "Not quite. While brevity can be good, vagueness usually leads to generic or unhelpful AI outputs. Specificity and context are key for getting good results.", sectionLink: 5 }, { q: "Which of these is a commonly cited potential *benefit* of using AI tools for teachers?", type: 'mc', options: ["Guaranteed error-free content", "Increased efficiency in certain tasks", "Reduced need for classroom management", "Perfect understanding of student emotions"], answer: 1, feedback: ["AI can make mistakes ('hallucinate'), so assuming error-free content is risky.", "Correct! AI can help automate or speed up tasks like drafting materials or brainstorming, potentially saving teachers time.", "Classroom management relies heavily on human interaction and is not something AI currently addresses effectively.", "AI does not understand emotions; interpreting and responding to student emotions requires human empathy and expertise."], sectionLink: 8 }, { q: "What is the single most important safety precaution when considering using a public AI tool that might involve student topics?", type: 'mc', options: ["Ensure the AI has a friendly interface", "Strictly avoid inputting any personally identifiable student information (PII)", "Use the tool only during planning periods", "Check if the AI cites its sources"], answer: 1, feedback: ["A friendly interface doesn't guarantee data security.", "Correct! Protecting student privacy by never entering PII (names, specific details, etc.) into non-approved public tools is the paramount safety rule.", "Time of use doesn't affect data privacy risks.", "Source citation is a feature of some AI, but data privacy is a more fundamental safety concern."], sectionLink: 9 }, { q: "An AI tool that helps draft lesson plan ideas or worksheet questions falls into which general category?", type: 'mc', options: ["AI Grading Assistant", "Content Creation Tool", "Student Tutoring Platform", "Data Analytics Dashboard"], answer: 1, feedback: ["While related, AI grading focuses on evaluation, not initial drafting.", "Correct! Tools designed to help generate text like lesson plans, emails, or questions are considered content creation aids.", "Tutoring platforms are typically student-facing.", "Data analytics tools focus on interpreting existing data, not generating new content."], sectionLink: 6 }, { q: "A teacher uses AI to generate 3 different versions of instructions for an art project, tailored for different reading levels. This is a good example of using AI to support:", type: 'mc', options: ["Classroom discipline", "Student assessment", "Differentiation", "Technology repair"], answer: 2, feedback: ["This task isn't directly related to classroom discipline.", "While the instructions relate to an activity, the core function here isn't assessment.", "Correct! Creating varied materials to meet diverse learner needs (like different reading levels) is a key aspect of differentiation, and AI can assist with this.", "This is about content creation, not hardware repair."], sectionLink: 7 }, { q: "Relying solely on AI-generated information without cross-referencing or using professional judgment is risky primarily due to the potential for:", type: 'mc', options: ["The AI becoming too popular", "High subscription costs", "Inaccuracies or biases in the AI's output", "The AI running out of ideas"], answer: 2, feedback: ["Popularity isn't the main risk.", "Cost is a practical factor, but the quality of information is a more fundamental risk.", "Correct! AI can generate incorrect information ('hallucinate') or reflect biases from its training data. Critical evaluation and fact-checking are essential.", "While outputs can sometimes be repetitive, the main risk is the *quality* of the ideas, not the quantity."] , sectionLink: 8 }, { q: "What is a recommended 'low-stakes' way for a teacher to begin experimenting with AI?", type: 'mc', options: ["Using AI to write personalized feedback on student essays", "Asking AI to generate fun facts or jokes related to a lesson topic", "Having AI create and score a major unit test", "Letting AI respond to parent emails automatically"], answer: 1, feedback: ["Personalized feedback is high-stakes and requires significant teacher nuance.", "Correct! Tasks like generating fun facts, brainstorming, or creating simple, non-critical content are great low-stakes ways to start exploring AI.", "Creating and scoring high-stakes tests requires careful validation and is not a good starting point.", "Automating parent emails is risky due to the need for personalization, empathy, and accuracy."] , sectionLink: 10 }, { q: "True or False: The basic ideas behind Artificial Intelligence have only existed since the invention of the internet.", type: 'tf', answer: false, correctFeedback: "Correct! Foundational concepts about machines performing tasks requiring intelligence date back to the mid-20th century, well before the widespread adoption of the internet.", incorrectFeedback: "Not quite. While the internet and related technologies have accelerated AI development, the core ideas and early research began much earlier, around the 1950s.", sectionLink: 3 }, { q: "The principle of 'Human Oversight' primarily means that:", type: 'mc', options: ["Humans should watch AI while it works", "AI should supervise human teachers", "Teachers must always review, evaluate, and approve AI outputs before use", "Only humans are allowed to use AI tools"], answer: 2, feedback: ["Watching the AI isn't the core meaning; it's about the review process.", "This reverses the intended relationship; the human remains in charge.", "Correct! This is the essence of human oversight in this context ‚Äì the educator applies their professional judgment to the AI's suggestions or creations.", "This is incorrect; the principle guides *how* humans should interact with and manage AI tools."] , sectionLink: 9 } ]
        };

        let state = {
            currentSectionId: 1,
            quizResults: {},
            finalQuizCompleted: false,
            userName: ''
        };

        // --- DOM Element References (Consolidated) ---
        const sidebar = document.getElementById('sidebar');
        const openSidebarBtn = document.getElementById('openSidebarBtn');
        const closeSidebarBtn = document.getElementById('closeSidebarBtn');
        const contentArea = document.getElementById('contentArea');
        const sectionTitle = document.getElementById('sectionTitle');
        const sidebarLinks = document.querySelectorAll('.sidebar-link');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const quizModal = document.getElementById('quizModal');
        const quizTitle = document.getElementById('quizTitle');
        const quizContent = document.getElementById('quizContent');
        const submitQuizBtn = document.getElementById('submitQuizBtn');
        const resetQuizBtn = document.getElementById('resetQuizBtn');
        const closeQuizBtn = document.getElementById('closeQuizBtn');
        const resetModuleBtn = document.getElementById('resetModuleBtn');
        // Reference to the hidden audio player
        const sectionAudioPlayer = document.getElementById('sectionAudioPlayer');


        // --- Functions ---

        function loadState() {
            const savedState = localStorage.getItem('aiTeacherTrainingState');
            if (savedState) {
                try {
                    state = JSON.parse(savedState);
                    state.quizResults = state.quizResults || {};
                    state.currentSectionId = state.currentSectionId || 1;
                    state.finalQuizCompleted = state.finalQuizCompleted || false;
                    state.userName = state.userName || '';
                } catch (e) {
                    console.error("Failed to parse saved state, resetting.", e);
                    localStorage.removeItem('aiTeacherTrainingState');
                    state = { currentSectionId: 1, quizResults: {}, finalQuizCompleted: false, userName: '' };
                }
            } else {
                 state = { currentSectionId: 1, quizResults: {}, finalQuizCompleted: false, userName: '' };
            }
        }
        function saveState() {
             try { localStorage.setItem('aiTeacherTrainingState', JSON.stringify(state)); } catch (e) { console.error("Failed to save state:", e); alert("Warning: Could not save your progress. Local storage might be full or disabled."); }
        }

        function resetModule() {
            console.log("Reset Module button clicked.");
            const userConfirmed = window.confirm("Are you sure you want to reset all module progress? This cannot be undone.");
            console.log("Confirm result:", userConfirmed);

            if (userConfirmed) {
                console.log("User confirmed reset.");
                stopAudio(); // Stop any active audio
                localStorage.removeItem('aiTeacherTrainingState');
                state = { currentSectionId: 1, quizResults: {}, finalQuizCompleted: false, userName: '' };
                navigateToSection(1);
                const certOutput = document.getElementById('certificateOutput');
                if (certOutput) certOutput.classList.add('hidden');
                console.log("Module reset complete.");
            } else {
                 console.log("User cancelled reset.");
            }
        }

        // Updated renderSection to add audio player button
        function renderSection(sectionId) {
             const section = sections.find(s => s.id == sectionId);
             if (!section) { console.error("Section not found:", sectionId); contentArea.innerHTML = `<div class="bg-white p-6 rounded-lg shadow"><p class="text-red-600">Error: Content could not be loaded.</p></div>`; sectionTitle.textContent = 'Error'; return; }
             sectionTitle.textContent = section.title;

             // --- Add Audio Player Button HTML ---
             let audioButtonHtml = '';
             // Check if audio exists for this section
             if (sectionAudio[section.id]) {
                 audioButtonHtml = `
                    <button id="audioPlayerBtn" class="audio-player-btn no-print" title="Listen to section audio">
                        <i class="fas fa-play mr-1"></i> Listen
                    </button>
                 `;
             }

             let contentHtml = `<div class="bg-white p-8 rounded-lg shadow space-y-6">`;
             // Add button floated right, before the title
             contentHtml += audioButtonHtml;
             contentHtml += `<h3 class="text-2xl font-semibold mb-4 text-sky-700">${section.title}</h3>`;
             contentHtml += `<div class="readable-content space-y-4">`; // Wrapper for main content

             // --- SECTION SPECIFIC CONTENT ---
             switch (String(section.id)) {
                 // Cases 1-11 remain the same as previous version...
                case '1': contentHtml += `<p class="text-lg">Welcome, educators, to your introduction to Artificial Intelligence in the classroom!</p> <p>Feeling curious, excited, or maybe even a little apprehensive about AI? That's perfectly normal! This module is designed to demystify AI, explore its potential as a helpful tool for elementary teachers, and empower you to use it effectively and ethically.</p> <p>We'll journey through the basics, look at practical applications, and discuss how to navigate this technology safely.</p> <p><strong>What to expect in this module:</strong></p> <ul class="list-disc list-inside ml-4 space-y-1 text-gray-700"> <li>Simple explanations of core AI ideas (no complex code!).</li> <li>Real-world examples relevant to your K-5/K-6 workflow.</li> <li>Quick, low-stakes quizzes to reinforce key points.</li> <li>A strong focus on responsible and safe practices.</li> <li>A final check-in and a certificate to mark your learning journey.</li> </ul> <div class="my-6 p-4 bg-sky-50 rounded-lg text-center border border-sky-200 shadow-sm"> <img src="https://i.imgur.com/jdN5a0Z.png" alt="Teacher exploring AI concepts" class="mx-auto rounded shadow max-w-full h-auto mb-2" style="max-height: 300px;" onerror="this.style.display='none'; this.onerror=null;"> <p class="text-sm text-sky-600 font-medium mt-2">Let's explore the potential of AI together!</p> </div> <div class="text-center mt-8"> <button id="beginModuleBtn" class="px-8 py-3 text-lg text-white bg-green-600 rounded-md hover:bg-green-700 shadow-md transition duration-150 ease-in-out"> Begin Module <i class="fas fa-arrow-right ml-2"></i> </button> </div>`; break;
                case '2': contentHtml += `<p>Think of AI as creating computer systems that can perform tasks typically requiring human intelligence. This could be anything from understanding language (like chatbots) to recognizing images or making predictions based on data.</p> <p>A helpful analogy: Imagine a <span class="key-term">smart assistant</span> that learns from countless examples to help with specific jobs. It's not about conscious robots; it's about specialized tools.</p> <div class="reveal-container mt-4"> <details> <summary>AI vs. Regular Software? <i class="fas fa-info-circle ml-1 text-sky-500 text-xs"></i></summary> <div class="reveal-content"> Traditional software follows explicit, pre-programmed rules. If X happens, do Y. AI, especially machine learning, learns patterns from data to make predictions or decisions, often without explicit rules for every situation. It can adapt based on new data (though most common tools are pre-trained). </div> </details> </div> <p class="text-sm text-gray-600 mt-4">Most AI you encounter today is <span class="key-term">Narrow AI</span> ‚Äì designed for specific tasks (like translation or recommendations). <span class="key-term">Artificial General Intelligence (AGI)</span> (AI with human-like broad intelligence) ‚Äì is still largely theoretical.</p>`; break;
                case '3': contentHtml += `<p>While AI feels very current, its roots go back further than you might think! Understanding this brief history helps appreciate how we got here.</p> <p><strong>A Quick Journey Through Time:</strong></p> <div id="interactive-timeline-placeholder" class="my-6"> </div> <p>From email spam filters and navigation apps to the chatbots we interact with, AI is already woven into our daily lives. The pace of change is rapid, making continuous learning important!</p>`; break;
                case '4': contentHtml += `<p>So, how does AI *actually* learn? It's less like human understanding and more like incredibly sophisticated <span class="key-term">pattern recognition</span>.</p> <p><strong>Let's revisit our baking analogy with interactive definitions:</strong></p> <div class="flip-card-grid"> <div role="button" tabindex="0" class="flip-card-container"> <div class="flip-card"> <div class="flip-card-inner"> <div class="flip-card-front"> <i class="fas fa-database text-3xl mb-2"></i> <h4>Data</h4> <p>(Hover/Tap to reveal)</p> </div> <div class="flip-card-back"> <h5>Data: The Ingredients</h5> AI systems are trained on enormous datasets (text, images, etc.). Think millions of examples. Quality & diversity matter! </div> </div> </div> </div> <div role="button" tabindex="0" class="flip-card-container"> <div class="flip-card"> <div class="flip-card-inner"> <div class="flip-card-front"> <i class="fas fa-cogs text-3xl mb-2"></i> <h4>Algorithms</h4> <p>(Hover/Tap to reveal)</p> </div> <div class="flip-card-back"> <h5>Algorithms: The Recipe</h5> Complex mathematical instructions AI uses to analyze data and find patterns. Different algorithms suit different tasks. </div> </div> </div> </div> <div role="button" tabindex="0" class="flip-card-container"> <div class="flip-card"> <div class="flip-card-inner"> <div class="flip-card-front"> <i class="fas fa-chart-line text-3xl mb-2"></i> <h4>Learning</h4> <p>(Hover/Tap to reveal)</p> </div> <div class="flip-card-back"> <h5>Learning: Refining</h5> AI makes predictions, checks accuracy, and adjusts internal parameters to improve performance based on patterns found in the data. </div> </div> </div> </div> </div> <p class="mt-4">Essentially, AI becomes proficient at tasks like translation, summarization, or image generation by processing countless examples and learning the statistical likelihood of certain patterns occurring together.</p> <div class="my-6 p-4 bg-emerald-50 rounded-lg text-center border border-emerald-200 shadow-sm"> <img src="https://i.imgur.com/b4xTGcO.png" alt="Diagram showing Data -> Algorithm -> Pattern Recognition" class="mx-auto rounded shadow max-w-full h-auto mb-2" style="max-height: 150px;" onerror="this.style.display='none'; this.onerror=null;"> <p class="text-sm text-emerald-600 font-medium mt-2">AI excels at finding complex patterns within vast amounts of data.</p> </div> <p class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-4 rounded-r-lg"> <strong class="block font-semibold">Crucial Distinction:</strong> This pattern matching isn't the same as human understanding, reasoning, or consciousness. An AI can write about empathy without feeling it, or discuss scientific concepts without truly comprehending the underlying principles. It's mimicking patterns it learned from human-generated text. </p>`; break;
                case '5': contentHtml += `<p>Getting useful results from AI often depends heavily on how you ask! Your instructions, or <span class="key-term">prompts</span>, are the key to unlocking the AI's potential for your specific needs.</p> <p>Think of it as communicating with a very capable, very literal assistant who needs clear directions. The better your prompt, the better the result.</p> <p><strong>Key Ingredients for Effective Prompts (The C.R.A.F.T. Method - simplified):</strong></p> <ul class="list-none ml-4 space-y-3 text-gray-700"> <li><i class="fas fa-bullseye text-sky-600 mr-2 fa-fw"></i><strong>Context:</strong> Who is the audience? What's the background?</li> <li><i class="fas fa-user-tag text-purple-600 mr-2 fa-fw"></i><strong>Role:</strong> What persona should the AI adopt? (e.g., teacher, student, historian)</li> <li><i class="fas fa-pencil-ruler text-amber-600 mr-2 fa-fw"></i><strong>Action/Task:</strong> What specific verb should the AI perform? (Generate, Explain, List...)</li> <li><i class="fas fa-list-ol text-lime-600 mr-2 fa-fw"></i><strong>Format:</strong> How should the output be structured? (Bullet points, paragraph, table...)</li> <li><i class="fas fa-crosshairs text-red-600 mr-2 fa-fw"></i><strong>Target/Topic:</strong> What specific subject or details should it focus on?</li> </ul> <p class="mt-4"><strong>Prompting is Iterative: Weak -> Better -> Stronger</strong></p> <div class="prompt-comparison my-4"> <div class="prompt-box prompt-weak"> <h4>Weak:</h4> <p class="italic">"Lesson plan."</p> <p class="text-sm text-gray-600 mt-2">(Too vague. What subject? What grade? What topic?)</p> </div> <div class="prompt-box prompt-strong"> <h4>Better:</h4> <p class="italic">"Lesson plan ideas for 2nd grade science."</p> <p class="text-sm text-gray-600 mt-2">(Getting closer, but still broad.)</p> </div> </div> <div class="mt-4 p-4 border border-green-300 bg-green-50 rounded-lg"> <h4 class="font-semibold text-green-700">Stronger Prompt:</h4> <p class="italic text-green-800">"Generate 3 creative lesson plan ideas for a 2nd-grade science class about the properties of matter (solid, liquid, gas). Include a hands-on activity suggestion and one potential assessment question for each idea. Present the output in bullet points."</p> <p class="text-sm text-gray-600 mt-2">(Clear goal, context, details, and format lead to a much more useful result.)</p> </div> <p class="mt-4">Don't expect perfection on the first try! View prompting as a conversation. Analyze the AI's response and refine your prompt to guide it closer to what you need.</p> <div class="my-6 p-4 bg-rose-50 rounded-lg text-center border border-rose-200 shadow-sm"> <img src="https://i.imgur.com/4cY5XJt.png" alt="Diagram showing prompt elements leading to better output" class="mx-auto rounded shadow max-w-full h-auto mb-2" style="max-height: 150px;" onerror="this.style.display='none'; this.onerror=null;"> <p class="text-sm text-rose-600 font-medium mt-2">Clear, detailed prompts lead to more helpful AI responses.</p> </div>`; break;
                case '6': contentHtml += `<p>The world of AI tools can seem overwhelming! Instead of focusing on specific brand names (which change rapidly), let's understand the main <span class="key-term">categories</span> of tools relevant to educators.</p> <p><strong>Common AI Tool Categories for Your Teacher Toolkit:</strong></p> <div class="grid md:grid-cols-2 gap-6 mt-4"> <div class="p-5 bg-sky-50 border border-sky-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"> <h4 class="font-semibold text-sky-700 mb-2"><i class="fas fa-pencil-alt mr-2 fa-fw"></i>Content Creation Aids</h4> <p class="text-sm text-gray-700">These tools excel at generating text based on your prompts. Think of them as writing assistants.</p> <p class="text-xs text-gray-500 mt-1"><em>Use for: Drafting lesson outlines, generating varied practice questions, writing initial email drafts, creating newsletter snippets, simplifying complex text.</em></p> </div> <div class="p-5 bg-lime-50 border border-lime-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"> <h4 class="font-semibold text-lime-700 mb-2"><i class="fas fa-lightbulb mr-2 fa-fw"></i>Idea Generation & Brainstorming</h4> <p class="text-sm text-gray-700">Stuck for ideas? AI can be a fantastic brainstorming partner, offering diverse perspectives and starting points.</p> <p class="text-xs text-gray-500 mt-1"><em>Use for: Finding creative lesson hooks, brainstorming project themes, generating writing prompts, suggesting discussion questions, exploring different ways to explain a concept.</em></p> </div> <div class="p-5 bg-amber-50 border border-amber-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"> <h4 class="font-semibold text-amber-700 mb-2"><i class="fas fa-tasks mr-2 fa-fw"></i>Assessment & Feedback Aids</h4> <p class="text-sm text-gray-700">Some AI tools can assist with creating assessment materials or providing initial feedback (always review carefully!).</p> <p class="text-xs text-gray-500 mt-1"><em>Use for: Generating multiple-choice or T/F questions, creating rubric templates, suggesting feedback criteria, providing grammar/spelling checks (with caution on meaning).</em></p> </div> <div class="p-5 bg-violet-50 border border-violet-200 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"> <h4 class="font-semibold text-violet-700 mb-2"><i class="fas fa-universal-access mr-2 fa-fw"></i>Accessibility Tools</h4> <p class="text-sm text-gray-700">AI significantly enhances tools that support diverse learners and communication needs.</p> <p class="text-xs text-gray-500 mt-1"><em>Use for: Text-to-speech (reading text aloud), speech-to-text (dictation), real-time translation, simplifying complex language for readability.</em></p> </div> </div> <div class="reveal-container mt-6"> <details> <summary>What about AI Image Generators? <i class="fas fa-info-circle ml-1 text-sky-500 text-xs"></i></summary> <div class="reveal-content"> AI image generators (like Midjourney, DALL-E) create images from text prompts. While potentially useful for custom classroom visuals, they require careful prompting and critical review for appropriateness, bias, and accuracy. Copyright considerations are also complex. Start with text-based tools first! </div> </details> </div> <p class="mt-6">The key is not to master every tool, but to understand the <span class="key-term">types</span> of tasks AI can assist with and develop strong <span class="key-term">prompting skills</span>. Always investigate a tool's <span class="key-term">privacy policy</span> and ensure it aligns with your school's guidelines before using it, especially if any student information might be involved (even indirectly).</p> <div class="my-6 p-4 bg-teal-50 rounded-lg text-center border border-teal-200 shadow-sm"> <img src="https://i.imgur.com/RAhNsXE.png" alt="AI toolbox graphic with category icons" class="mx-auto rounded shadow max-w-full h-auto mb-2" style="max-height: 150px;" onerror="this.style.display='none'; this.onerror=null;"> <p class="text-sm text-teal-600 font-medium mt-2">Knowing the categories helps you choose the right tool for the job.</p> </div>`; break;
                case '7': contentHtml += `<p>Let's see the difference prompting makes! Instead of just showing examples, try simulating an AI interaction below. Click 'Submit' for each prompt to see a potential AI response.</p> <hr class="my-6 border-gray-300"> <h4 class="text-lg font-semibold mb-3 text-indigo-700">Scenario 1: Differentiating Reading Questions</h4> <p class="mb-4 text-sm text-gray-600">Goal: Get reading comprehension questions for Chapter 2 of 'Charlotte's Web' for a 3rd-grade class.</p> <div class="mb-6"> <h5 class="font-semibold mb-2">Attempt 1: Basic Prompt</h5> <div class="sim-prompt-box"> <code>Write reading questions for Charlotte's Web Chapter 2.</code> </div> <button data-response-target="response-s1-basic" class="sim-submit-btn sim-prompt-submit">Submit Basic Prompt</button> <div id="response-s1-basic" class="sim-response-box"> <strong class="block mb-2">Simulated AI Response:</strong> <p>1. What happens in Chapter 2?<br>2. Who are the main characters introduced?<br>3. Describe the setting.<br><em>(Critique: Very generic, not specific to grade level or question types needed.)</em></p> </div> </div> <div class="mb-6"> <h5 class="font-semibold mb-2">Attempt 2: Detailed (CRAFT) Prompt</h5> <div class="sim-prompt-box"> <code>Generate 3 reading comprehension questions about Chapter 2 of 'Charlotte's Web' suitable for a 3rd-grade class. Include one literal question, one inferential question, and one evaluative question.</code> </div> <button data-response-target="response-s1-detailed" class="sim-submit-btn sim-prompt-submit">Submit Detailed Prompt</button> <div id="response-s1-detailed" class="sim-response-box"> <strong class="block mb-2">Simulated AI Response:</strong> <p>1. (Literal) What was the first message Charlotte wrote in her web?<br>2. (Inferential) Why did Charlotte decide to help Wilbur?<br>3. (Evaluative) Do you think it's fair for Templeton to demand food in exchange for help? Why or why not?<br><em>(Critique: Much better! Questions are specific, varied, and targeted to the grade level.)</em></p> </div> </div> <hr class="my-8 border-gray-300"> <h4 class="text-lg font-semibold mb-3 text-indigo-700">Scenario 2: Drafting Parent Communication</h4> <p class="mb-4 text-sm text-gray-600">Goal: Draft a short reminder email about an upcoming field trip.</p> <div class="mb-6"> <h5 class="font-semibold mb-2">Attempt 1: Basic Prompt</h5> <div class="sim-prompt-box"> <code>Write email about field trip.</code> </div> <button data-response-target="response-s2-basic" class="sim-submit-btn sim-prompt-submit">Submit Basic Prompt</button> <div id="response-s2-basic" class="sim-response-box"> <strong class="block mb-2">Simulated AI Response:</strong> <p>Subject: Field Trip<br><br>Dear Parents,<br>Reminder about the field trip.<br>Thanks,<br>Teacher<br><em>(Critique: Too brief, lacks essential details like date, destination, what to bring.)</em></p> </div> </div> <div class="mb-6"> <h5 class="font-semibold mb-2">Attempt 2: Detailed (CRAFT) Prompt</h5> <div class="sim-prompt-box"> <code>Write a short, friendly paragraph for our weekly 2nd-grade classroom newsletter reminding families about the upcoming field trip to the City Zoo next Friday, May 10th. Mention they need signed permission slips returned by Wednesday, May 8th, and should pack a lunch and drink. Keep the tone positive.</code> </div> <button data-response-target="response-s2-detailed" class="sim-submit-btn sim-prompt-submit">Submit Detailed Prompt</button> <div id="response-s2-detailed" class="sim-response-box"> <strong class="block mb-2">Simulated AI Response:</strong> <p>Just a friendly reminder that our exciting 2nd-grade field trip to the City Zoo is coming up next Friday, May 10th! Please make sure your child returns their signed permission slip by this Wednesday, May 8th, so they can join the fun. Also, remember to pack a yummy lunch and drink for them on the day of the trip. We can't wait for our animal adventure!</p> <em>(Critique: Includes all necessary details in a suitable tone.)</em> </div> </div> <p class="mt-6 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-4 rounded-r-lg"> <strong class="block font-semibold"><i class="fas fa-lightbulb mr-1"></i> Key Takeaway:</strong> Notice how adding specific details (Context, Role, Action, Format, Target) significantly improves the quality and usefulness of the AI's response. Remember to always review and personalize any AI-generated text before using it! </p>`; break;
                case '8': contentHtml += `<p>Embracing AI means understanding both its bright possibilities and its potential pitfalls. A balanced perspective is key to using it wisely.</p> <p><strong>Weighing the Pros and Cons for Educators:</strong></p> <div class="benefit-challenge-grid my-6"> <div class="benefit-box"> <h4><i class="fas fa-check-circle mr-2"></i>Potential Benefits (The Upside)</h4> <ul> <li>Efficiency & Time Savings</li> <li>Idea Generation & Creativity Spark</li> <li>Support for Differentiation</li> <li>Enhanced Accessibility</li> <li>Personalization Potential (Future)</li> </ul> </div> <div class="challenge-box"> <h4><i class="fas fa-exclamation-triangle mr-2"></i>Challenges & Considerations (The Cautions)</h4> <ul> <li>Accuracy & "Hallucinations"</li> <li>Potential Bias</li> <li>Data Privacy & Security Risks</li> <li>Risk of Over-Reliance</li> <li>Ethical Use & Academic Integrity</li> <li>Equity & Access (Digital Divide)</li> </ul> </div> </div> <p>Approach AI as a powerful but flawed <span class="key-term">assistant</span>. Leverage its speed and pattern-finding abilities, but always apply your <span class="key-term">professional judgment</span>, <span class="key-term">critical thinking</span>, and <span class="key-term">ethical compass</span>. You remain the expert on your students and your classroom context.</p> <div class="my-6 p-4 bg-orange-50 rounded-lg text-center border border-orange-200 shadow-sm"> <img src="https://i.imgur.com/EPfm2wG.png" alt="Scale balancing AI benefits and risks" class="mx-auto rounded shadow max-w-full h-auto mb-2" style="max-height: 150px;" onerror="this.style.display='none'; this.onerror=null;"> <p class="text-sm text-orange-600 font-medium mt-2">A balanced understanding leads to more effective and responsible AI integration.</p> </div>`; break;
                case '9': contentHtml += `<p>Using AI effectively goes hand-in-hand with using it <span class="key-term">responsibly</span> and <span class="key-term">ethically</span>. Protecting students and upholding professional standards must always be the priority.</p> <p><strong>Your Safety & Ethics Checklist:</strong></p> <ul class="safety-checklist list-none p-0 my-4 space-y-4"> <li><i class="fas fa-shield-alt text-red-shield"></i> <strong>Guard Student Privacy (PII):</strong> This is paramount. <span class="font-bold">NEVER input Personally Identifiable Information (PII)</span> about students (names, grades, specific personal details, photos) into public AI tools unless explicitly approved and vetted by your school/district for compliance with privacy laws (like FERPA/COPPA). Anonymize any necessary scenarios.</li> <li><i class="fas fa-balance-scale text-blue-check"></i> <strong>Verify Accuracy & Check for Bias:</strong> Treat AI output as a first draft. <span class="font-semibold">Fact-check critical information.</span> Read carefully for biases. Discard or heavily edit biased content.</li> <li><i class="fas fa-info-circle text-yellow-info"></i> <strong>Practice Transparency:</strong> Be open about your use of AI with relevant stakeholders as appropriate per your context and policies. Don't represent significant AI work as solely your own.</li> <li><i class="fas fa-user-check text-purple-eye"></i> <strong>Exercise Human Oversight & Judgment:</strong> You are the educator! <span class="font-semibold">Always review, edit, and approve AI content</span> before use. Ensure pedagogical fit and appropriateness.</li> <li><i class="fas fa-copyright text-cyan-600"></i> <strong>Consider Copyright:</strong> Be mindful of the evolving legal landscape. Avoid using AI to directly replicate copyrighted material. Focus on ideas and drafts.</li> <li><i class="fas fa-gavel text-gray-policy"></i> <strong>Adhere to Policies:</strong> <span class="font-bold">Know and follow your school and district's Acceptable Use Policies (AUP)</span> regarding AI tools, data security, and digital citizenship.</li> </ul> <p><strong>Thinking Through Scenarios:</strong></p> <ul class="list-none p-0 space-y-2 mt-4"> <li><span class="inline-block bg-green-100 text-green-700 px-2 py-0.5 rounded text-sm mr-2">SAFER <i class="fas fa-check"></i></span> Asking AI: "Generate 5 ideas for teaching fractions using visual aids for 3rd graders."</li> <li><span class="inline-block bg-red-100 text-red-700 px-2 py-0.5 rounded text-sm mr-2">RISKY <i class="fas fa-times"></i></span> Pasting this into a public AI: "My student Maria G. is struggling with fractions... Give me ideas." (Contains PII - Personally Identifiable Information).</li> <li><span class="inline-block bg-green-100 text-green-700 px-2 py-0.5 rounded text-sm mr-2">SAFER <i class="fas fa-check"></i></span> Using AI to create a *template* for a parent email, then personalizing and reviewing it thoroughly.</li> <li><span class="inline-block bg-red-100 text-red-700 px-2 py-0.5 rounded text-sm mr-2">RISKY <i class="fas fa-times"></i></span> Relying on AI for definitive advice on handling specific student behavior issues without consulting school resources.</li> </ul> <div class="my-6 p-4 bg-red-50 rounded-lg text-center border border-red-200 shadow-sm"> <img src="https://i.imgur.com/DrKjhe9.png" alt="Shield protecting student data icon" class="mx-auto rounded shadow max-w-full h-auto mb-2" style="max-height: 150px;" onerror="this.style.display='none'; this.onerror=null;"> <p class="text-sm text-red-600 font-medium mt-2">Ethical considerations and safety protocols must guide our AI use.</p> </div>`; break;
                case '10': contentHtml += `<p>Feeling ready to dip your toes into using AI? Excellent! The best approach is <span class="key-term">thoughtful experimentation</span>, starting small and building confidence.</p> <p><strong>Practical Steps for Getting Started:</strong></p> <ol class="getting-started-steps list-none p-0 my-4 space-y-5"> <li> <strong>Identify a Low-Stakes, High-Impact Task:</strong> What takes time but errors aren't critical? <em class="block text-sm text-gray-600 mt-1">Examples: Brainstorming prompts, generating fun facts, drafting reminder templates, finding synonyms.</em> </li> <li> <strong>Consult Your District's Guidance & Tools:</strong> <span class="font-bold">Check policies FIRST.</span> Use approved tools if available. Be cautious with others. </li> <li> <strong>Craft a Clear, Contextual Prompt:</strong> Remember Section 4! Define task, context, details, format. </li> <li> <strong>Critically Review & Iterate:</strong> Treat AI output as raw material. Check accuracy, bias, appropriateness. <span class="font-semibold">Refine your prompt</span> and try again if needed. </li> <li> <strong>Reflect & Learn:</strong> Did it help? What worked? What didn't? Share with colleagues. </li> </ol> <p><strong>Mindset Matters:</strong></p> <ul class="list-disc list-inside ml-4 space-y-2 text-gray-700"> <li>Aim for <span class="key-term">augmentation</span>, not automation.</li> <li>Embrace <span class="key-term">curiosity</span>. Find reliable EdTech resources.</li> <li>Prioritize <span class="key-term">ethics and student well-being</span>.</li> <li>Collaborate! Talk to colleagues.</li> </ul> <div class="my-6 p-4 bg-green-50 rounded-lg text-center border border-green-200 shadow-sm"> <img src="https://i.imgur.com/xhmxwoG.png" alt="Small steps leading upwards with AI icon" class="mx-auto rounded shadow max-w-full h-auto mb-2" style="max-height: 150px;" onerror="this.style.display='none'; this.onerror=null;"> <p class="text-sm text-green-600 font-medium mt-2">Start small, stay critical, adhere to policy, and focus on augmenting your practice.</p> </div>`; break;
                case '11': contentHtml += `<p class="text-lg font-semibold text-green-700">Module Complete! You've taken a significant step in understanding AI in education.</p> <p>We've journeyed from the basic definition of AI and its history to practical ways it can assist in your elementary classroom, emphasizing the crucial importance of ethical and responsible use.</p> <p><strong>Let's Recap Your Key Learning Targets:</strong></p> <ul class="summary-points list-none p-0 my-4 space-y-3 text-gray-700"> <li>Describe AI simply, recognize its history and types.</li> <li>Understand AI learns via patterns, not comprehension.</li> <li>Craft effective prompts (goal, context, specifics, format).</li> <li>Identify key AI tool categories for teachers.</li> <li>Articulate AI benefits and challenges in education.</li> <li>Apply principles for safe/ethical AI use (privacy, oversight).</li> <li>Outline steps for thoughtful AI integration.</li> </ul> <p class="mt-4">The world of AI is dynamic, but the principles of good teaching ‚Äì critical thinking, ethical responsibility, understanding your students, and pedagogical expertise ‚Äì remain paramount. AI is a tool; <span class="font-bold">you</span> are the educator.</p> <div class="my-6 p-4 bg-sky-50 rounded-lg text-center border border-sky-200 shadow-sm"> <img src="https://i.imgur.com/2OWv54v.png" alt="Graduation cap pointing towards final quiz" class="mx-auto rounded shadow max-w-full h-auto mb-2" style="max-height: 150px;" onerror="this.style.display='none'; this.onerror=null;"> <p class="text-sm text-sky-600 font-medium mt-2">Consolidate your learning with the final quiz!</p> </div> <p><strong>What's Next?</strong></p> <p>To complete the module and earn your certificate, proceed to the <strong>Final Quiz</strong>. This quiz covers key concepts from all the sections you've explored.</p> <p>Click the "Next" button below when you're ready. Good luck!</p>`; break;
                 // --- Special Sections ---
                case 'final-quiz': contentHtml += `<p class="text-lg font-medium">Final Knowledge Check!</p> <p>This final quiz assesses your understanding of the key concepts covered throughout the module. It includes ${quizzes['final-quiz']?.length || 10} questions drawn from all sections.</p> <p>Remember, if you get stuck on a question, the feedback for incorrect answers will link back to the relevant section for review.</p>`; const finalResult = state.quizResults['final-quiz']; if (finalResult?.completed) { contentHtml += `<div class="mt-6 p-4 bg-blue-50 rounded-md border border-blue-200 shadow-sm"> <p class="text-blue-700 font-medium">You have previously completed the final quiz.</p> <p class="text-sm text-blue-600">Your last score was: ${finalResult.score}/${finalResult.total}</p> <button id="startFinalQuizBtn" class="mt-3 px-5 py-2 text-sm text-white bg-sky-600 rounded-md hover:bg-sky-700 shadow transition duration-150 ease-in-out">Retake Final Quiz</button> </div>`; } else { contentHtml += `<button id="startFinalQuizBtn" class="mt-6 px-8 py-3 text-lg text-white bg-green-600 rounded-md hover:bg-green-700 shadow-md transition duration-150 ease-in-out">Start Final Quiz</button>`; } break;
                case 'certificate': contentHtml += `<h4 class="text-2xl font-semibold text-green-700 mb-4"><i class="fas fa-award mr-2"></i>Module Complete!</h4> <p>Congratulations on successfully completing the AI Training Module for Elementary Teachers!</p>`; if (state.finalQuizCompleted) { contentHtml += `<p class="mt-2 text-gray-700">You've demonstrated your understanding of key AI concepts and responsible use in education. Generate your personalized certificate below.</p> <div class="mt-6"> <label for="certificateName" class="block text-base font-medium text-gray-700 mb-2">Enter Your Name for the Certificate:</label> <input type="text" id="certificateName" value="${state.userName || ''}" placeholder="Your Full Name" class="w-full max-w-md p-2 border border-gray-300 rounded-md shadow-sm focus:ring-sky-500 focus:border-sky-500 text-center text-lg"> <button id="generateCertBtn" class="mt-4 px-8 py-3 text-lg text-white bg-sky-500 rounded-md hover:bg-sky-600 no-print shadow transition duration-150 ease-in-out">Generate Certificate</button> </div> <div id="certificateOutput" class="mt-8 hidden"> </div>`; } else { contentHtml += `<p class="mt-4 text-red-600 font-medium">You must successfully complete the <a href="#" onclick="navigateToSection('final-quiz'); return false;" class="text-sky-600 hover:underline font-semibold">Final Quiz</a> before you can generate your certificate.</p>`; } break;
                default: contentHtml += `<p>Content loading error.</p>`;
             }
             // --- END SECTION SPECIFIC CONTENT ---

             // Close readable content div
             contentHtml += `</div>`;

             // Add 'Take Quiz' button if applicable for regular sections
             if (section.quiz && section.id !== 'final-quiz' && section.id !== 'certificate') {
                 const quizResult = state.quizResults[section.id];
                 contentHtml += `<hr class="my-8 border-gray-300">`;
                 contentHtml += `<h4 class="text-lg font-semibold mb-4 text-center text-gray-700">Check Your Understanding</h4>`;
                 if (quizResult?.completed) {
                     contentHtml += `<div class="mt-4 p-4 bg-green-50 rounded-lg border border-green-200 flex flex-col sm:flex-row justify-between items-center space-y-2 sm:space-y-0 shadow-sm"> <div class="text-center sm:text-left"> <p class="text-green-800 font-medium">Section ${section.id} Quiz Completed!</p> <p class="text-sm text-green-700">Your score: ${quizResult.score}/${quizResult.total}</p> </div> <button data-quiz-id="${section.id}" class="retakeQuizBtn px-5 py-2 text-sm text-white bg-sky-600 rounded-md hover:bg-sky-700 shadow transition duration-150 ease-in-out whitespace-nowrap">Retake Quiz</button> </div>`;
                 } else {
                     contentHtml += `<div class="mt-4 text-center"> <button data-quiz-id="${section.id}" class="takeQuizBtn px-8 py-3 text-lg text-white bg-green-600 rounded-md hover:bg-green-700 shadow-md transition duration-150 ease-in-out">Take Section ${section.id} Quiz</button> </div>`;
                 }
             }

             contentHtml += `</div>`; // Close bg-white container
             contentArea.innerHTML = contentHtml;

             // Special handling for interactive timeline in Section 3
             if (section.id === 3) {
                 injectTimeline(); // Call function to inject and initialize timeline
             }

             attachDynamicButtonListeners(); // Use delegation now
             updateNavButtons();
             updateSidebarActive();
        }

        // Function to inject and initialize the interactive timeline
        function injectTimeline() {
            const placeholder = document.getElementById('interactive-timeline-placeholder');
            if (!placeholder) return;

            // Inject Timeline HTML structure
            placeholder.innerHTML = `
                <div class="timeline-container-enhanced">
                    <div class="timeline-line"></div>
                    <div class="timeline-items-wrapper hide-scrollbar needs-swipe-hint">
                        <div class="timeline-items" id="timeline-items-container">
                            </div>
                    </div>
                </div>
                <div id="details-container" class="details-section">
                    <h3 id="details-title" class="font-semibold text-xl mb-2">Explore the Timeline</h3>
                    <p id="details-content" class="text-sm mb-3">Click on an era above to discover key developments, milestones, and interesting facts about the evolution of AI.</p>
                    <div id="details-milestones" class="mb-3"></div>
                    <div id="details-factoid"></div>
                </div>
            `;

            // Timeline Data
            const eventDetails = {
                event1: { id: "event1", year: "1950s", title: "Foundational Ideas", content: "Early pioneers like Alan Turing explored 'thinking machines.' The term 'Artificial Intelligence' was coined at the Dartmouth Workshop (1956). Focus was on symbolic reasoning, problem-solving, and logic.", milestones: [ { text: "Turing Test proposed", icon: "fa-solid fa-lightbulb" }, { text: "Logic Theorist program (early AI)", icon: "fa-solid fa-brain" }, { text: "Perceptron invented (early neural net)", icon: "fa-solid fa-circle-nodes" } ], factoid: "Did you know? The Dartmouth Workshop, which coined the term 'AI', brought together researchers who predicted significant progress within a generation." },
                event2: { id: "event2", year: "1960s-80s", title: "Early Explorations & Winters", content: "Initial excitement led to research in areas like natural language processing (ELIZA) and robotics (Shakey). However, limitations in computing power, data, and overly ambitious goals led to 'AI winters'‚Äîperiods of reduced funding.", milestones: [ { text: "ELIZA chatbot created", icon: "fa-solid fa-comment-dots" }, { text: "Shakey the robot developed", icon: "fa-solid fa-robot" }, { text: "First 'AI Winter' begins (~mid-70s)", icon: "fa-solid fa-snowflake" } ], factoid: "Did you know? The Lighthill Report in the UK heavily criticized AI research in 1973, contributing significantly to the first 'AI Winter'." },
                event3: { id: "event3", year: "1980s-00s", title: "Rise of Machine Learning", content: "Focus shifted towards Machine Learning‚Äîenabling computers to learn from data. Expert systems saw commercial success initially. Key algorithms like backpropagation revitalized neural networks.", milestones: [ { text: "Expert Systems boom", icon: "fa-solid fa-briefcase" }, { text: "Backpropagation algorithm popularized", icon: "fa-solid fa-arrows-rotate" }, { text: "Support Vector Machines (SVMs) developed", icon: "fa-solid fa-diagram-project" } ], factoid: "Did you know? Backpropagation, a key algorithm for training neural networks, was largely overlooked for years before gaining widespread recognition in the mid-1980s." },
                event4: { id: "event4", year: "2010s-Now", title: "Deep Learning, Big Data & Power", content: "Deep Learning (using deep neural networks) fueled by massive datasets ('Big Data') and powerful GPUs led to breakthroughs in image/speech recognition, NLP, and game playing.", milestones: [ { text: "ImageNet Challenge breakthroughs", icon: "fa-solid fa-image" }, { text: "Rise of GPUs for AI", icon: "fa-solid fa-microchip" }, { text: "AlphaGo defeats Go champion", icon: "fa-solid fa-chess-board" } ], factoid: "Did you know? GPUs, originally designed for graphics, turned out to be exceptionally well-suited for the parallel computations required by deep learning, accelerating progress immensely." },
                event5: { id: "event5", year: "Recent Years", title: "The Generative Boom", content: "Powerful Generative AI models (Transformers, GPT, Diffusion Models) emerged, capable of creating human-like text, images, code, and more, transforming industries and sparking public imagination.", milestones: [ { text: "'Attention Is All You Need' (Transformers)", icon: "fa-solid fa-file-lines" }, { text: "Emergence of GPT models", icon: "fa-solid fa-pen-fancy" }, { text: "Diffusion models for image generation", icon: "fa-solid fa-palette" } ], factoid: "Did you know? The 'Transformer' architecture, introduced in 2017, is the foundation for many of today's most powerful large language models, including GPT and Gemini." }
            };

            const timelineItemsContainer = document.getElementById('timeline-items-container');
            if (!timelineItemsContainer) return;

            Object.values(eventDetails).forEach(event => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'timeline-item group';
                itemDiv.setAttribute('data-id', event.id);
                itemDiv.innerHTML = `<div class="timeline-point-enhanced"></div><span class="timeline-label">${event.year}</span>`;
                itemDiv.addEventListener('click', () => updateTimelineDetails(event.id, eventDetails));
                timelineItemsContainer.appendChild(itemDiv);
            });
             updateTimelineDetails('event1', eventDetails); // Select first item
        }

        // Function to update the timeline details display
        function updateTimelineDetails(eventId, eventDetails) {
            const details = eventDetails[eventId];
             const detailsTitle = document.getElementById('details-title');
             const detailsContent = document.getElementById('details-content');
             const detailsMilestones = document.getElementById('details-milestones');
             const detailsFactoid = document.getElementById('details-factoid');

            if (details && detailsTitle && detailsContent && detailsMilestones && detailsFactoid) {
                detailsTitle.textContent = details.title + ` (${details.year})`;
                detailsContent.textContent = details.content;
                detailsMilestones.innerHTML = '';
                if (details.milestones && details.milestones.length > 0) {
                    const milestonesTitle = document.createElement('h4');
                    milestonesTitle.className = 'font-medium text-md text-slate-800 mb-1';
                    milestonesTitle.textContent = 'Key Milestones:';
                    detailsMilestones.appendChild(milestonesTitle);
                    const list = document.createElement('ul');
                    list.className = 'milestones-list text-sm';
                    details.milestones.forEach(milestone => {
                        const listItem = document.createElement('li');
                        listItem.innerHTML = `<i class="${milestone.icon || 'fa-solid fa-star'}"></i> ${milestone.text}`;
                        list.appendChild(listItem);
                    });
                    detailsMilestones.appendChild(list);
                }
                detailsFactoid.innerHTML = '';
                if (details.factoid) {
                    const factoidP = document.createElement('p');
                    factoidP.className = 'factoid text-sm';
                    factoidP.innerHTML = `<i class="fa-solid fa-circle-info mr-2"></i> ${details.factoid}`;
                    detailsFactoid.appendChild(factoidP);
                }
                document.querySelectorAll('.timeline-item').forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('data-id') === eventId) {
                        item.classList.add('active');
                    }
                });
                 const detailsContainer = document.getElementById('details-container');
                 if(detailsContainer) detailsContainer.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
                 console.error("Could not find all elements needed to update timeline details.");
            }
        }


        // Use event delegation for dynamic buttons
        function attachDynamicButtonListeners() {
            // Event delegation handled within the DOMContentLoaded listener below
        }

        // updateNavButtons updated for Welcome section and highlight
        function updateNavButtons() {
            const currentIndex = sections.findIndex(s => String(s.id) == String(state.currentSectionId));
            prevBtn.disabled = currentIndex === 0;

            const currentSection = sections[currentIndex];
            let canProceed = true;

            if (currentSection && currentSection.id !== 1 && currentSection.quiz && !state.quizResults[currentSection.id]?.completed) {
                 canProceed = false;
            }
             if (currentSection && currentSection.id === 'final-quiz' && !state.finalQuizCompleted) {
                 canProceed = false;
             }

            nextBtn.classList.toggle('hidden', state.currentSectionId === 1 || state.currentSectionId === 'certificate');
            prevBtn.classList.toggle('hidden', state.currentSectionId === 1);

            // Add/Remove highlight class based on whether the button is enabled AND the previous section quiz was completed
            const previousSectionIndex = currentIndex > 0 ? currentIndex -1 : -1;
            const previousSection = previousSectionIndex !== -1 ? sections[previousSectionIndex] : null;
            const shouldHighlight = previousSection && previousSection.quiz && state.quizResults[previousSection.id]?.completed && !nextBtn.disabled;

            nextBtn.classList.toggle('highlight-next', shouldHighlight);

            nextBtn.disabled = currentIndex === sections.length - 1 || !canProceed;
        }

        // Update sidebar active link - ADDED aria-current
        function updateSidebarActive() {
            sidebarLinks.forEach(link => {
                const sectionId = link.getAttribute('data-section');
                if (sectionId == String(state.currentSectionId)) {
                    link.classList.add('active');
                    link.setAttribute('aria-current', 'page'); // Add aria-current
                } else {
                    link.classList.remove('active');
                    link.removeAttribute('aria-current'); // Remove aria-current
                }
            });
        }
        // navigateToSection updated to cancel audio and remove prefetch
         function navigateToSection(sectionId) {
             stopAudio(); // Stop audio on navigation
             removeAudioPrefetch(); // Remove any existing prefetch link

             const targetSectionId = String(sectionId);
             const targetIndex = sections.findIndex(s => String(s.id) === targetSectionId);
             if (targetIndex < 0) { console.error("Target section not found:", targetSectionId); return; }
             state.currentSectionId = sections[targetIndex].id;
             renderSection(state.currentSectionId);
             saveState();
             if (window.innerWidth < 768 && !sidebar.classList.contains('-translate-x-full')) { sidebar.classList.add('-translate-x-full'); }
             contentArea.scrollTop = 0;
              // Remove highlight from next button when navigating
             nextBtn.classList.remove('highlight-next');
         }

        // --- Quiz Logic ---
        let currentQuizId = null; let currentQuizAnswers = {}; let quizAttempted = false;

        // Updated openQuiz to add prefetch link
        function openQuiz(quizId) {
            currentQuizId = quizId;
            const quizData = quizzes[quizId];
            if (!quizData) { console.error("Quiz data not found for:", quizId); return; }

            const section = sections.find(s => String(s.id) == String(quizId));
            const title = quizId === 'final-quiz' ? "Final Quiz" : `Section ${quizId}: ${section?.title} Quiz`;
            quizTitle.textContent = title;

            quizContent.innerHTML = '';
            quizAttempted = false;
            currentQuizAnswers = {};

            quizData.forEach((q, index) => { const questionId = `q-${quizId}-${index}`; const questionElement = document.createElement('div'); questionElement.id = questionId; questionElement.className = 'mb-6 p-4 border border-gray-200 rounded-lg bg-white shadow-sm'; questionElement.innerHTML = `<p class="font-medium mb-3 text-gray-800">${index + 1}. ${q.q}</p>`; const optionsElement = document.createElement('div'); optionsElement.className = 'space-y-2'; const inputName = `q${index}`;
                if (q.type === 'mc' || q.type === 'ordering_mc') { q.options.forEach((option, optIndex) => { const optionId = `${questionId}-opt${optIndex}`; optionsElement.innerHTML += `<label for="${optionId}" class="flex items-center p-3 border border-gray-300 rounded-md hover:bg-sky-50 cursor-pointer transition duration-150 ease-in-out"> <input type="radio" id="${optionId}" name="${inputName}" value="${optIndex}" class="mr-3 focus:ring-sky-500 h-4 w-4 text-sky-600 border-gray-300"> <span class="text-gray-700">${option}</span> </label>`; }); }
                else if (q.type === 'tf') { const trueOptionId = `${questionId}-optTrue`; const falseOptionId = `${questionId}-optFalse`; optionsElement.innerHTML += `<label for="${trueOptionId}" class="flex items-center p-3 border border-gray-300 rounded-md hover:bg-sky-50 cursor-pointer transition duration-150 ease-in-out"> <input type="radio" id="${trueOptionId}" name="${inputName}" value="true" class="mr-3 focus:ring-sky-500 h-4 w-4 text-sky-600 border-gray-300"> <span class="text-gray-700">True</span> </label> <label for="${falseOptionId}" class="flex items-center p-3 border border-gray-300 rounded-md hover:bg-sky-50 cursor-pointer transition duration-150 ease-in-out"> <input type="radio" id="${falseOptionId}" name="${inputName}" value="false" class="mr-3 focus:ring-sky-500 h-4 w-4 text-sky-600 border-gray-300"> <span class="text-gray-700">False</span> </label>`; }
                else if (q.type === 'matching') { let selectOptionsHtml = `<option value="">-- Select a match --</option>`; q.options.forEach(opt => { selectOptionsHtml += `<option value="${opt.id}">${opt.text}</option>`; }); q.items.forEach((item, itemIndex) => { const selectId = `${questionId}-match${itemIndex}`; optionsElement.innerHTML += `<div class="matching-item"> <label for="${selectId}" class="matching-term">${item.term}:</label> <select id="${selectId}" name="${inputName}-${item.id}" class="matching-select focus:ring-sky-500 focus:border-sky-500"> ${selectOptionsHtml} </select> </div>`; }); }
                questionElement.appendChild(optionsElement); const feedbackElement = document.createElement('div'); feedbackElement.id = `feedback-${index}`; feedbackElement.className = 'mt-4 text-sm'; questionElement.appendChild(feedbackElement); if (quizId === 'final-quiz' && q.sectionLink) { const remediationElement = document.createElement('div'); remediationElement.id = `remediation-${index}`; remediationElement.className = 'mt-2 text-sm hidden'; questionElement.appendChild(remediationElement); } quizContent.appendChild(questionElement);
            });
            // Event delegation handles quiz input changes now
            submitQuizBtn.classList.remove('hidden'); resetQuizBtn.classList.remove('hidden'); closeQuizBtn.classList.add('hidden'); quizModal.classList.remove('hidden'); quizContent.scrollTop = 0;

            // --- Prefetch next section's audio ---
            prefetchNextAudio(quizId);
        }

        // Updated submitQuiz - Removed alert() calls
        function submitQuiz() {
            if (quizAttempted) return;

            const quizData = quizzes[currentQuizId];
            let score = 0;
            let allAnswered = true;
            let firstUnansweredIndex = -1;

            quizData.forEach((q, index) => {
                const selectedAnswer = currentQuizAnswers[index];
                const feedbackEl = document.getElementById(`feedback-${index}`);
                const remediationEl = document.getElementById(`remediation-${index}`);

                feedbackEl.innerHTML = '';
                feedbackEl.className = 'mt-4 text-sm';
                if (remediationEl) remediationEl.classList.add('hidden');
                const questionElement = document.getElementById(`q-${currentQuizId}-${index}`);
                questionElement.querySelectorAll('label, select').forEach(el => el.classList.remove('answer-correct', 'answer-incorrect'));
                questionElement.querySelectorAll('input, select').forEach(inp => inp.disabled = false);

                let isCorrect = false;
                let isQuestionAnswered = true;

                if (q.type === 'mc' || q.type === 'tf' || q.type === 'ordering_mc') {
                    if (selectedAnswer === undefined) {
                        isQuestionAnswered = false;
                        feedbackEl.textContent = 'Please select an answer.';
                    } else {
                        isCorrect = (selectedAnswer === q.answer);
                        const selectedInput = questionElement.querySelector(`input[name="q${index}"][value="${q.type === 'tf' ? String(selectedAnswer) : selectedAnswer}"]`);
                        if (selectedInput) {
                            selectedInput.closest('label').classList.add(isCorrect ? 'answer-correct' : 'answer-incorrect');
                        }
                    }
                } else if (q.type === 'matching') {
                    isCorrect = true;
                    if (!selectedAnswer || Object.keys(selectedAnswer).length < q.items.length || Object.values(selectedAnswer).some(val => !val)) {
                        isQuestionAnswered = false;
                         feedbackEl.textContent = 'Please make a selection for each item.';
                         q.items.forEach((item, itemIndex) => {
                            const selectEl = questionElement.querySelector(`#q-${currentQuizId}-${index}-match${itemIndex}`);
                            if (selectEl && (!selectedAnswer || !selectedAnswer[item.id])) {
                                selectEl.classList.add('border-red-400');
                            } else if (selectEl) {
                                 selectEl.classList.remove('border-red-400');
                            }
                         });
                    } else {
                         q.items.forEach((item, itemIndex) => {
                             const correctOptionId = q.answer[item.id];
                             const selectedOptionId = selectedAnswer[item.id];
                             const selectEl = questionElement.querySelector(`#q-${currentQuizId}-${index}-match${itemIndex}`);
                             if (selectedOptionId === correctOptionId) {
                                 selectEl.classList.add('answer-correct');
                             } else {
                                 selectEl.classList.add('answer-incorrect');
                                 isCorrect = false;
                             }
                         });
                    }
                }

                if (!isQuestionAnswered) {
                    allAnswered = false;
                    feedbackEl.className = 'mt-4 text-sm text-red-600 font-medium';
                    if (firstUnansweredIndex === -1) firstUnansweredIndex = index;
                    return;
                }

                questionElement.querySelectorAll('input, select').forEach(inp => inp.disabled = true);

                // --- MODIFIED FEEDBACK LOGIC (No change here) ---
                if (isCorrect) {
                    score++;
                    let feedbackText = q.correctFeedback || '';
                    if ((q.type === 'mc' || q.type === 'ordering_mc') && q.feedback && q.feedback.length > q.answer) {
                         feedbackText = q.feedback[q.answer];
                    }
                    feedbackEl.innerHTML = `<span class="feedback-title text-green-700">Correct!</span> ${feedbackText}`;
                    feedbackEl.className = 'mt-4 text-sm feedback-correct';
                } else {
                    let feedbackText = '';
                    if ((q.type === 'mc' || q.type === 'ordering_mc') && typeof selectedAnswer === 'number' && q.feedback && q.feedback.length > selectedAnswer) {
                         feedbackText = q.feedback[selectedAnswer];
                    } else if (q.type === 'tf') {
                        feedbackText = q.incorrectFeedback || "That wasn't the correct answer.";
                    } else if (q.type === 'matching') {
                         feedbackText = q.incorrectFeedback || "One or more matches are incorrect. Please review.";
                    } else {
                        feedbackText = "That wasn't the correct answer. Try reviewing the section content.";
                    }
                    feedbackEl.innerHTML = `<span class="feedback-title text-red-700">Not Quite...</span> ${feedbackText}`;
                    feedbackEl.className = 'mt-4 text-sm feedback-incorrect';

                    if (remediationEl && q.sectionLink) {
                        const targetSection = sections.find(s => String(s.id) == String(q.sectionLink));
                        remediationEl.innerHTML = `Need a refresher? Review <a href="#" onclick="event.preventDefault(); navigateToSection(${q.sectionLink}); closeQuiz();" class="text-sky-600 hover:underline font-medium">Section ${q.sectionLink}: ${targetSection?.title || ''}</a>`;
                        remediationEl.classList.remove('hidden');
                    }
                }
                 // --- END MODIFIED FEEDBACK LOGIC ---
            });

            if (!allAnswered) {
                 if (firstUnansweredIndex !== -1) { const questionElement = quizContent.children[firstUnansweredIndex]; questionElement?.scrollIntoView({ behavior: 'smooth', block: 'center' }); }
                 // REMOVED alert() for unanswered questions
                 console.warn("Not all questions answered.");
                 quizData.forEach((q, index) => { if (currentQuizAnswers[index] === undefined || (q.type === 'matching' && Object.keys(currentQuizAnswers[index] || {}).length < q.items.length)) { document.getElementById(`q-${currentQuizId}-${index}`)?.querySelectorAll('input, select').forEach(opt => opt.disabled = false); } });
                 return;
            }

            quizAttempted = true;
            const result = { score: score, total: quizData.length, completed: true, answers: { ...currentQuizAnswers } };

             // REMOVED alert() calls
             if (currentQuizId === 'final-quiz') {
                 state.finalQuizCompleted = true;
                 state.quizResults[currentQuizId] = result;
                 console.log(`Final Quiz Completed! Score: ${score}/${quizData.length}.`);
             } else {
                 state.quizResults[currentQuizId] = result;
                 console.log(`Section ${currentQuizId} Quiz Completed! Score: ${score}/${quizData.length}.`);
             }

            saveState();
            submitQuizBtn.classList.add('hidden');
            resetQuizBtn.classList.remove('hidden');
            closeQuizBtn.classList.remove('hidden');
            renderSection(state.currentSectionId); // Re-render to update quiz status
            updateNavButtons(); // Update nav buttons immediately after quiz submission
        }

        // resetQuiz, closeQuiz remain the same
         function resetQuiz() { /* Function remains the same */ if (currentQuizId === 'final-quiz') { state.finalQuizCompleted = false; delete state.quizResults['final-quiz']; saveState(); renderSection(state.currentSectionId); } openQuiz(currentQuizId); }
        function closeQuiz() { /* Function remains the same */ stopAudio(); quizModal.classList.add('hidden'); currentQuizId = null; renderSection(state.currentSectionId); }

        // generateCertificate updated to use Intl.DateTimeFormat
        function generateCertificate() {
            const nameInput = document.getElementById('certificateName');
            const outputDiv = document.getElementById('certificateOutput');
            const userName = nameInput.value.trim();

            if (!userName) {
                alert("Please enter your name for the certificate.");
                nameInput.focus();
                return;
            }

            state.userName = userName;
            saveState();

            const dateFormatter = new Intl.DateTimeFormat(undefined, {
                year: 'numeric', month: 'long', day: 'numeric'
            });
            const completionDate = dateFormatter.format(new Date());


            outputDiv.innerHTML = `
                <div class="border-8 border-double border-sky-600 p-8 bg-gradient-to-br from-sky-50 to-blue-100 rounded-lg shadow-xl relative">
                     <div class="absolute top-4 left-4 text-sky-400 text-3xl opacity-50"><i class="fas fa-certificate"></i></div>
                     <div class="absolute bottom-4 right-4 text-sky-400 text-3xl opacity-50 transform rotate-12"><i class="fas fa-graduation-cap"></i></div>
                    <h2 class="text-3xl md:text-4xl font-bold text-sky-800 mb-5 tracking-tight">Certificate of Completion</h2>
                    <p class="text-lg text-gray-700 mb-3">This certifies that</p>
                    <p class="text-2xl md:text-3xl font-semibold text-indigo-700 mb-4 break-words border-b-2 border-indigo-200 pb-2 inline-block">${userName}</p>
                    <p class="text-lg text-gray-700 mb-3">has successfully completed the</p>
                    <p class="text-xl md:text-2xl font-medium text-gray-800 mb-6">AI Training Module for Elementary Teachers</p>
                    <div class="w-1/3 h-1 bg-sky-300 mx-auto my-8 rounded"></div>
                    <p class="text-base text-gray-600">Issued on: ${completionDate}</p>
                    <p class="text-sm text-gray-500 mt-5 italic px-4">This module covered foundational AI concepts, practical applications in the elementary classroom, ethical considerations, and strategies for safe and responsible integration.</p>
                    <button onclick="window.print()" class="mt-8 px-8 py-3 text-white bg-sky-600 rounded-lg hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-sky-500 no-print transition duration-150 ease-in-out shadow-md text-lg font-medium">
                        <i class="fas fa-print mr-2"></i>Print Certificate
                    </button>
                </div>
            `;
            outputDiv.classList.remove('hidden');
        }

        // --- NEW: Audio Player Functions ---
        let currentAudioSectionId = null; // Track which section's audio is loaded/playing

        // Function to update the audio player button state
        function updateAudioPlayerButton(button, isPlaying, isPaused) {
             if (!button) return;
             if (isPlaying && !isPaused) {
                 button.innerHTML = '<i class="fas fa-pause mr-1"></i> Pause Audio';
                 button.classList.add('playing');
                 button.classList.remove('paused');
                 button.title = "Pause audio playback";
             } else if (isPlaying && isPaused) {
                 button.innerHTML = '<i class="fas fa-play mr-1"></i> Resume Audio';
                 button.classList.add('paused');
                 button.classList.remove('playing');
                 button.title = "Resume audio playback";
             } else { // Stopped or not loaded
                 button.innerHTML = '<i class="fas fa-play mr-1"></i> Listen';
                 button.classList.remove('playing', 'paused');
                 button.title = "Listen to section audio";
             }
        }

        // Function to stop audio playback and reset button
        function stopAudio() {
            if (sectionAudioPlayer && !sectionAudioPlayer.paused) {
                sectionAudioPlayer.pause();
                sectionAudioPlayer.currentTime = 0; // Reset to beginning
                console.log("Audio stopped.");
            }
            currentAudioSectionId = null; // Clear tracked section
            // Reset any potentially active button
            document.querySelectorAll('.audio-player-btn').forEach(btn => updateAudioPlayerButton(btn, false, false));
        }

        // Function to handle play/pause toggle
        function toggleAudioPlayback(button, sectionId) {
            const audioSrc = sectionAudio[sectionId];
            if (!audioSrc) {
                console.error("No audio source found for section:", sectionId);
                alert("Audio not available for this section.");
                return;
            }

            // If clicking button for a *different* section, stop current audio first
            if (currentAudioSectionId !== null && currentAudioSectionId !== sectionId) {
                stopAudio();
            }

            // Load new source if needed or if stopped
            if (sectionAudioPlayer.src !== audioSrc || sectionAudioPlayer.paused && sectionAudioPlayer.currentTime === 0) {
                sectionAudioPlayer.src = audioSrc;
                currentAudioSectionId = sectionId; // Track the new section
                sectionAudioPlayer.load(); // Load the new source
                sectionAudioPlayer.play().then(() => {
                    updateAudioPlayerButton(button, true, false);
                    console.log("Audio playing:", audioSrc);
                }).catch(error => {
                    console.error("Audio play failed:", error);
                    alert("Could not play audio. Please check console for errors.");
                    updateAudioPlayerButton(button, false, false);
                });
            } else if (sectionAudioPlayer.paused) {
                // Resume playback
                sectionAudioPlayer.play().then(() => {
                     updateAudioPlayerButton(button, true, false);
                     console.log("Audio resumed.");
                }).catch(error => {
                     console.error("Audio resume failed:", error);
                     updateAudioPlayerButton(button, false, false); // Reset button if resume fails
                });
            } else {
                // Pause playback
                sectionAudioPlayer.pause();
                updateAudioPlayerButton(button, true, true);
                console.log("Audio paused.");
            }

             // Add event listener for when audio naturally ends
             sectionAudioPlayer.onended = () => {
                 console.log("Audio ended.");
                 updateAudioPlayerButton(button, false, false);
                 currentAudioSectionId = null; // Clear tracked section
             };
             // Add error handling
             sectionAudioPlayer.onerror = (e) => {
                 console.error("Audio player error:", e);
                 alert("An error occurred while trying to play the audio.");
                 updateAudioPlayerButton(button, false, false);
                 currentAudioSectionId = null;
             };
        }

        // --- NEW: Audio Prefetch Functions ---
        function removeAudioPrefetch() {
            const existingPrefetch = document.getElementById('audio-prefetch-link');
            if (existingPrefetch) {
                existingPrefetch.remove();
                // console.log("Removed previous audio prefetch link.");
            }
        }

        function prefetchNextAudio(currentQuizSectionId) {
            removeAudioPrefetch(); // Remove any old one first

            const currentSectionIndex = sections.findIndex(s => String(s.id) === String(currentQuizSectionId));
            if (currentSectionIndex === -1 || currentSectionIndex >= sections.length - 1) {
                return; // No next section or current section not found
            }

            const nextSection = sections[currentSectionIndex + 1];
            const nextAudioSrc = sectionAudio[nextSection.id];

            if (nextAudioSrc) {
                const prefetchLink = document.createElement('link');
                prefetchLink.id = 'audio-prefetch-link'; // ID to easily find and remove it later
                prefetchLink.rel = 'prefetch';
                prefetchLink.href = nextAudioSrc;
                prefetchLink.as = 'audio';
                document.head.appendChild(prefetchLink);
                console.log("Prefetching audio for section:", nextSection.id, nextAudioSrc);
            }
        }


        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            // Attach static listeners
            if (openSidebarBtn) openSidebarBtn.addEventListener('click', () => sidebar.classList.remove('-translate-x-full'));
            if (closeSidebarBtn) closeSidebarBtn.addEventListener('click', () => sidebar.classList.add('-translate-x-full'));
            sidebarLinks.forEach(link => { link.addEventListener('click', (e) => { e.preventDefault(); const sectionId = e.target.closest('a').getAttribute('data-section'); navigateToSection(sectionId); }); });
            if (prevBtn) prevBtn.addEventListener('click', () => { const currentIndex = sections.findIndex(s => String(s.id) == String(state.currentSectionId)); if (currentIndex > 0) navigateToSection(sections[currentIndex - 1].id); });
            if (nextBtn) nextBtn.addEventListener('click', () => { const currentIndex = sections.findIndex(s => String(s.id) == String(state.currentSectionId)); const currentSection = sections[currentIndex]; let canProceed = true; if (currentSection && currentSection.id !== 1 && currentSection.quiz && !state.quizResults[currentSection.id]?.completed) { canProceed = false; } if (currentSection && currentSection.id === 'final-quiz' && !state.finalQuizCompleted) { canProceed = false; } if (currentIndex < sections.length - 1 && canProceed) { navigateToSection(sections[currentIndex + 1].id); } else if (!canProceed) { if (currentSection && currentSection.quiz) { alert(`Please complete the quiz for "${currentSection.title}" before proceeding.`); } else if (currentSection && currentSection.id === 'final-quiz') { alert(`Please complete the Final Quiz before proceeding to the certificate.`); } } });
            if (submitQuizBtn) submitQuizBtn.addEventListener('click', submitQuiz);
            if (resetQuizBtn) resetQuizBtn.addEventListener('click', resetQuiz);
            if (closeQuizBtn) closeQuizBtn.addEventListener('click', closeQuiz);
            if (resetModuleBtn) resetModuleBtn.addEventListener('click', resetModule);

            // Event delegation for dynamic buttons inside content area
            if (contentArea) {
                contentArea.addEventListener('click', function(event) {
                    const target = event.target.closest('button');
                    if (!target) return;

                    if (target.matches('.takeQuizBtn') || target.matches('.retakeQuizBtn')) {
                        const quizId = target.getAttribute('data-quiz-id');
                        if (quizId) openQuiz(quizId);
                    } else if (target.matches('#startFinalQuizBtn')) {
                        openQuiz('final-quiz');
                    } else if (target.matches('#generateCertBtn')) {
                        generateCertificate();
                    } else if (target.matches('#beginModuleBtn')) {
                        navigateToSection(2);
                    } else if (target.matches('.sim-prompt-submit')) {
                         event.preventDefault();
                         const responseTargetId = target.getAttribute('data-response-target');
                         const responseBox = document.getElementById(responseTargetId);
                         if (responseBox) {
                             responseBox.classList.add('visible');
                             target.disabled = true;
                             target.textContent = 'Response Shown';
                         }
                    } else if (target.matches('#audioPlayerBtn')) { // Handle Audio Player button
                        toggleAudioPlayback(target, state.currentSectionId);
                    }
                });
                 contentArea.addEventListener('input', function(event) {
                     if (event.target.matches('#certificateName')) {
                         state.userName = event.target.value;
                     }
                 });
            }
             // Event delegation for quiz inputs
             if (quizContent) {
                 quizContent.addEventListener('change', (e) => {
                     if (quizAttempted) return;
                     const targetInput = e.target;
                     if (!targetInput.matches('input[type="radio"], select.matching-select')) return;
                     const qIndex = parseInt(targetInput.name.match(/q(\d+)/)[1]);
                     const questionData = quizzes[currentQuizId]?.[qIndex];
                     if (!questionData) return;
                     if (questionData.type === 'matching') {
                         if (!currentQuizAnswers[qIndex]) currentQuizAnswers[qIndex] = {};
                         const itemId = targetInput.name.split('-')[1];
                         currentQuizAnswers[qIndex][itemId] = targetInput.value;
                     } else {
                         let value = targetInput.value;
                         if (questionData.type === 'tf') { value = (value === 'true'); }
                         else if (questionData.type === 'mc' || questionData.type === 'ordering_mc') { value = parseInt(value); }
                         currentQuizAnswers[qIndex] = value;
                     }
                     const feedbackEl = document.getElementById(`feedback-${qIndex}`);
                     if (feedbackEl && (feedbackEl.textContent === 'Please select an answer.' || feedbackEl.textContent === 'Please make a selection for each item.')) {
                         feedbackEl.textContent = '';
                         feedbackEl.className = 'mt-4 text-sm';
                     }
                 });
             }

            // Close sidebar on outside click (for mobile)
            document.addEventListener('click', (event) => { if (window.innerWidth < 768) { const sidebar = document.getElementById('sidebar'); const openSidebarBtn = document.getElementById('openSidebarBtn'); if (sidebar && !sidebar.classList.contains('-translate-x-full')) { const isClickInsideSidebar = sidebar.contains(event.target); const isClickOnOpenButton = openSidebarBtn && openSidebarBtn.contains(event.target); if (!isClickInsideSidebar && !isClickOnOpenButton) { sidebar.classList.add('-translate-x-full'); } } } });

            // Stop audio if the window is closed/unloaded
            window.addEventListener('beforeunload', stopAudio);

            // --- Initialization ---
            loadState();
            navigateToSection(state.currentSectionId); // Load initial section
        });

    </script>

</body>
</html>
