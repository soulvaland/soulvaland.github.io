<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pathfinder Character Sheet</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="stylesheet" href="pathfinder_styles.css"> 
    <link href="data:image/x-icon;base64," rel="icon" type="image/x-icon"/> 
</head>
<body>
    <div class="relative flex size-full min-h-screen flex-col justify-between group/design-root">
        <div class="flex-grow overflow-y-auto pb-28">
            <header class="sticky top-0 z-20 flex items-center bg-[#0d1117]/80 backdrop-blur-md p-4 pb-3 justify-between border-b border-[#243447]">
                <div class="w-auto flex items-center">
                    <button id="share-sheet-btn" title="Share Sheet (Copy Link)" class="action-button h-8 w-8 owner-edit-btn mr-2">
                        <span class="material-icons" style="font-size: 18px;">share</span>
                    </button>
                    <button id="my-sheets-header-btn" title="My Sheets" class="action-button h-8 w-auto px-3 mr-2 text-sm hidden">
                        <span class="material-icons" style="font-size: 18px;">folder_shared</span> My Sheets
                    </button>
                    <div id="user-display-container" class="hidden items-center mr-2">
                        <span id="user-email-display" class="text-sm text-[#93acc8] mr-2"></span>
                        <button id="logout-btn" title="Logout" class="action-button h-8 w-auto px-2 text-xs mr-2">
                            <span class="material-icons" style="font-size: 16px;">logout</span> Logout
                        </button>
                        <button id="toggle-edit-mode-btn" title="Toggle Edit Mode" class="action-button h-8 w-auto px-2 text-xs hidden">
                            <span class="material-icons edit-mode-icon" style="font-size: 16px;">edit</span> 
                            <span class="edit-mode-text">Edit</span>
                        </button>
                    </div>
                </div>
                <h1 class="text-xl font-bold tracking-tight text-center text-[#e0e0e0] flex-1 header-font">Pathfinder Character Sheet</h1>
                <div class="flex w-auto items-center justify-end">
                    <button id="login-modal-btn" title="Login / Sign Up" class="action-button h-8 w-auto px-3 mr-2 text-sm">
                        <span class="material-icons" style="font-size: 18px;">login</span> Login
                    </button>
                    <button id="settings-btn" title="Settings" class="flex items-center justify-center rounded-full h-10 w-10 text-[#93acc8] hover:text-white hover:bg-[#1a2532] transition-colors">
                        <span class="material-icons">settings</span>
                    </button>
                </div>
            </header>

            <section class="p-4 @container">
                <div class="flex flex-col items-center gap-4 mb-6">
                    <div class="relative">
                        <div id="char-image-display" class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-32 w-32 border-2 border-[#1873dc]" style='background-image: url("https://placehold.co/128x128/1a2532/93acc8?text=Char");'>
                        </div>
                        <button id="edit-image-btn" title="Edit Image" class="absolute bottom-0 right-0 action-button h-8 w-8 owner-edit-btn">
                            <span class="material-icons" style="font-size: 18px;">edit</span>
                        </button>
                    </div>
                    <div class="flex flex-col items-center justify-center text-center">
                        <p id="char-name" class="text-[#e0e0e0] text-3xl font-bold leading-tight tracking-tight header-font owner-edit-target">Alistair Thorne</p>
                        <p id="char-class-level" class="text-[#93acc8] text-md font-normal leading-normal owner-edit-target">Level 5 Ranger</p>
                        <p id="char-alignment" class="text-[#93acc8] text-sm font-normal leading-normal owner-edit-target">Neutral Good</p>
                        <div class="text-[#93acc8] text-sm font-normal leading-normal mt-1 space-y-0.5">
                            <p><strong>Deity:</strong> <span id="char-deity" class="owner-edit-target">Erastil</span> <span class="mx-1">|</span> <strong>Age:</strong> <span id="char-age" class="owner-edit-target">28</span> <span class="mx-1">|</span> <strong>Gender:</strong> <span id="char-gender" class="owner-edit-target">Male</span></p>
                            <p><strong>Height:</strong> <span id="char-height" class="owner-edit-target">6'0"</span> <span class="mx-1">|</span> <strong>Weight:</strong> <span id="char-weight" class="owner-edit-target">180 lbs</span></p>
                            <p><strong>Hair:</strong> <span id="char-hair" class="owner-edit-target">Brown</span> <span class="mx-1">|</span> <strong>Eyes:</strong> <span id="char-eyes" class="owner-edit-target">Green</span></p>
                        </div>
                    </div>
                </div>
            </section>

            <section class="px-4 pb-2">
                <h2 class="text-[#e0e0e0] text-xl font-semibold tracking-tight mb-3 header-font card-header-physical">Attributes</h2>
                <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
                    <div class="ornate-stat-card owner-edit-target">
                        <p class="stat-label">Strength</p><p class="stat-value"><span id="attr-strength-score">16</span> <span id="attr-strength-mod" class="text-lg text-[#93acc8]">(+3)</span></p>
                    </div>
                    <div class="ornate-stat-card owner-edit-target">
                        <p class="stat-label">Dexterity</p><p class="stat-value"><span id="attr-dexterity-score">14</span> <span id="attr-dexterity-mod" class="text-lg text-[#93acc8]">(+2)</span></p>
                    </div>
                    <div class="ornate-stat-card owner-edit-target">
                        <p class="stat-label">Constitution</p><p class="stat-value"><span id="attr-constitution-score">15</span> <span id="attr-constitution-mod" class="text-lg text-[#93acc8]">(+2)</span></p>
                    </div>
                    <div class="ornate-stat-card owner-edit-target">
                        <p class="stat-label">Intelligence</p><p class="stat-value"><span id="attr-intelligence-score">12</span> <span id="attr-intelligence-mod" class="text-lg text-[#93acc8]">(+1)</span></p>
                    </div>
                    <div class="ornate-stat-card owner-edit-target">
                        <p class="stat-label">Wisdom</p><p class="stat-value"><span id="attr-wisdom-score">13</span> <span id="attr-wisdom-mod" class="text-lg text-[#93acc8]">(+1)</span></p>
                    </div>
                    <div class="ornate-stat-card owner-edit-target">
                        <p class="stat-label">Charisma</p><p class="stat-value"><span id="attr-charisma-score">10</span> <span id="attr-charisma-mod" class="text-lg text-[#93acc8]">(+0)</span></p>
                    </div>
                </div>
            </section>

            <section id="class-progression-section" class="px-4 pt-6 pb-2">
                <h2 class="text-[#e0e0e0] text-xl font-semibold tracking-tight mb-3 header-font card-header-skill">Class Progression</h2>
                <div class="content-card grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div>
                        <label for="classmech-hit-die" class="block text-sm font-medium text-[#93acc8] mb-1">Hit Die</label>
                        <select id="classmech-hit-die" class="modal-input owner-edit-target-input w-full">
                            <option value="d4">d4</option>
                            <option value="d6">d6</option>
                            <option value="d8">d8</option>
                            <option value="d10">d10</option>
                            <option value="d12">d12</option>
                        </select>
                    </div>
                    <div>
                        <label for="classmech-bab-progression" class="block text-sm font-medium text-[#93acc8] mb-1">Base Attack Bonus</label>
                        <select id="classmech-bab-progression" class="modal-input owner-edit-target-input w-full">
                            <option value="full">Full (e.g., Fighter, Paladin)</option>
                            <option value="threeQuarters">3/4 (e.g., Cleric, Rogue)</option>
                            <option value="half">1/2 (e.g., Wizard, Sorcerer)</option>
                        </select>
                    </div>
                    <div>
                        <label for="classmech-fort-save" class="block text-sm font-medium text-[#93acc8] mb-1">Fortitude Save</label>
                        <select id="classmech-fort-save" class="modal-input owner-edit-target-input w-full">
                            <option value="good">Good</option>
                            <option value="poor">Poor</option>
                        </select>
                    </div>
                    <div>
                        <label for="classmech-ref-save" class="block text-sm font-medium text-[#93acc8] mb-1">Reflex Save</label>
                        <select id="classmech-ref-save" class="modal-input owner-edit-target-input w-full">
                            <option value="good">Good</option>
                            <option value="poor">Poor</option>
                        </select>
                    </div>
                    <div>
                        <label for="classmech-will-save" class="block text-sm font-medium text-[#93acc8] mb-1">Will Save</label>
                        <select id="classmech-will-save" class="modal-input owner-edit-target-input w-full">
                            <option value="good">Good</option>
                            <option value="poor">Poor</option>
                        </select>
                    </div>
                    <div>
                        <label for="classmech-hp-ability" class="block text-sm font-medium text-[#93acc8] mb-1">HP Ability Mod</label>
                        <select id="classmech-hp-ability" class="modal-input owner-edit-target-input w-full">
                            <option value="CON">Constitution (Typical)</option>
                            <option value="STR">Strength</option>
                            <option value="DEX">Dexterity</option>
                            <option value="INT">Intelligence</option>
                            <option value="WIS">Wisdom</option>
                            <option value="CHA">Charisma</option>
                            <option value="None">None</option>
                        </select>
                    </div>
                    <div>
                        <label for="classmech-ac-ability1" class="block text-sm font-medium text-[#93acc8] mb-1">Primary AC Ability</label>
                        <select id="classmech-ac-ability1" class="modal-input owner-edit-target-input w-full">
                            <option value="DEX">Dexterity (Typical)</option>
                            <option value="STR">Strength</option>
                            <option value="CON">Constitution</option>
                            <option value="INT">Intelligence</option>
                            <option value="WIS">Wisdom</option>
                            <option value="CHA">Charisma</option>
                            <option value="None">None (Armor Only)</option>
                        </select>
                    </div>
                    <div>
                        <label for="classmech-ac-ability2" class="block text-sm font-medium text-[#93acc8] mb-1">Secondary AC Ability</label>
                        <select id="classmech-ac-ability2" class="modal-input owner-edit-target-input w-full">
                            <option value="None">None (Typical)</option>
                            <option value="WIS">Wisdom (e.g., Monk)</option>
                            <option value="INT">Intelligence (e.g., Duelist)</option>
                            <option value="CHA">Charisma (e.g., Paladin/Scaled Fist)</option>
                            <option value="STR">Strength</option>
                            <option value="DEX">Dexterity</option> 
                            <option value="CON">Constitution</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- Point Buy Calculator Toggle Button (Temporary placement) -->
            <section class="px-4 pt-3 pb-1 text-center">
                <button id="toggle-point-buy-btn" class="action-button action-button-sm owner-edit-btn">
                    <span class="material-icons">calculate</span> Point Buy Calculator
                </button>
            </section>

            <section class="px-4 pt-6 pb-2">
                <h2 class="text-[#e0e0e0] text-xl font-semibold tracking-tight mb-3 header-font card-header-physical">Key Stats</h2>
                <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
                    <div class="stat-card items-center owner-edit-target">
                        <p class="stat-label">HP</p> 
                        <p class="stat-value">
                            <span id="stat-hp-current" class="owner-edit-target-text">10</span>/<span id="stat-hp-max" class="owner-edit-target-text">10</span>
                        </p>
                    </div>
                    <div class="stat-card items-center owner-edit-target">
                         <div class="flex items-center gap-1"><span class="material-icons text-2xl text-[#93acc8]">security</span><p class="stat-label">AC</p></div>
                         <p id="stat-ac" class="stat-value">18</p>
                    </div>
                    <div class="stat-card items-center owner-edit-target">
                        <p class="stat-label text-xs">Armor Bonus</p>
                        <p id="stat-ac-armor" class="stat-value-small owner-edit-target-text">0</p>
                    </div>
                    <div class="stat-card items-center owner-edit-target">
                        <p class="stat-label text-xs">Shield Bonus</p>
                        <p id="stat-ac-shield" class="stat-value-small owner-edit-target-text">0</p>
                    </div>
                    <div class="stat-card items-center owner-edit-target">
                        <p class="stat-label text-xs">Misc AC Bonus</p>
                        <p id="stat-ac-misc" class="stat-value-small owner-edit-target-text">0</p>
                    </div>
                    <div class="stat-card items-center owner-edit-target"><p class="stat-label">Initiative</p><p id="stat-initiative" class="stat-value">+2</p></div>
                    <div class="stat-card items-center owner-edit-target"><p class="stat-label">BAB</p><p id="stat-bab" class="stat-value">+5</p></div>
                    <div class="stat-card items-center owner-edit-target"><p class="stat-label">Speed</p><p id="stat-speed" class="stat-value">30 ft</p></div>
                    <div class="stat-card items-center col-span-1 owner-edit-target"><p class="stat-label">Wealth</p><p id="stat-wealth" class="stat-value-small">1200 GP</p></div>
                </div>
                <div class="grid grid-cols-3 gap-3 mt-3">
                    <div class="stat-card items-center owner-edit-target"><p class="stat-label accent-physical">Fortitude</p><p id="stat-fortitude" class="stat-value">+7</p></div>
                    <div class="stat-card items-center owner-edit-target"><p class="stat-label accent-physical">Reflex</p><p id="stat-reflex" class="stat-value">+6</p></div>
                    <div class="stat-card items-center owner-edit-target"><p class="stat-label accent-mental">Will</p><p id="stat-will" class="stat-value">+3</p></div>
                </div>
                 <div class="grid grid-cols-2 gap-3 mt-3">
                    <div class="stat-card items-center owner-edit-target"><p class="stat-label">CMB</p><p id="stat-cmb" class="stat-value">+8</p></div>
                    <div class="stat-card items-center owner-edit-target"><p class="stat-label">CMD</p><p id="stat-cmd" class="stat-value">20</p></div>
                </div>
            </section>

            <section id="attacks-section" class="px-4 pt-6 pb-4">
                <div class="flex justify-between items-center mb-3">
                    <h2 class="text-[#e0e0e0] text-xl font-semibold tracking-tight header-font card-header-physical">Attacks & Actions</h2>
                    <button id="add-attack-btn" class="action-button action-button-sm owner-edit-btn">
                        <span class="material-icons">colorize</span> Add Attack
                    </button>
                </div>
                <div class="content-card">
                    <div class="attack-header-grid grid grid-cols-12 gap-x-2 items-center pb-1 mb-2 border-b-2 border-[#384d66] text-xs text-[#93acc8] font-semibold">
                        <span class="col-span-3">WEAPON/ACTION</span>
                        <span class="col-span-2 text-center">ATK BONUS</span>
                        <span class="col-span-2 text-center">DAMAGE</span>
                        <span class="col-span-1 text-center">CRIT</span>
                        <span class="col-span-2 text-center">TYPE/RANGE</span>
                        <span class="col-span-2 text-center">ACTIONS</span>
                    </div>
                    <ul id="attacks-list-container" class="space-y-1 text-sm">
                        <!-- JS will populate this -->
                        <!-- Example attack structure:
                        <li class="attack-item grid grid-cols-12 gap-x-2 items-center py-1.5 border-b border-[#243447] last:border-b-0">
                            <div class="col-span-3">
                                <p class="font-semibold text-[#e0e0e0]">Longsword</p>
                                <p class="text-xs text-[#b0c4de]">Masterwork, Power Attack</p>
                            </div>
                            <p class="col-span-2 text-center text-lg font-semibold">+7/+2</p>
                            <p class="col-span-2 text-center">1d8+3 S</p>
                            <p class="col-span-1 text-center">19-20/x2</p>
                            <p class="col-span-2 text-center">Melee / 5ft</p>
                            <div class="col-span-2 text-center space-x-1 owner-edit-block">
                                <button class="action-button-xs material-icons">edit</button>
                                <button class="action-button-xs destructive-btn-xs material-icons">delete</button>
                            </div>
                        </li>
                        -->
                    </ul>
                    <p id="no-attacks-message" class="text-[#93acc8] text-center py-3 hidden">No attacks defined.</p>
                </div>
            </section>

            <section id="feats-section" class="px-4 pt-6 pb-4">
                 <div class="flex justify-between items-center mb-3">
                    <h2 class="text-[#e0e0e0] text-xl font-semibold tracking-tight header-font">Feats</h2>
                     <button id="add-feat-btn" class="action-button action-button-sm owner-edit-btn">
                        <span class="material-icons">add</span> Add Feat
                    </button>
                </div>
                <div class="content-card">
                    <ul id="feats-list-container" class="space-y-2 text-sm">
                    </ul>
                </div>
            </section>

            <section id="inventory-section" class="px-4 pt-6 pb-4">
                <div class="flex justify-between items-center mb-3">
                    <h2 class="text-[#e0e0e0] text-xl font-semibold tracking-tight header-font card-header-physical">Inventory & Equipment</h2>
                    <button id="add-inventory-item-btn" class="action-button action-button-sm owner-edit-btn">
                        <span class="material-icons">add_shopping_cart</span> Add Item
                    </button>
                </div>

                <!-- Currency -->
                <div class="content-card mb-4">
                    <h3 class="text-lg font-semibold text-[#e0e0e0] mb-2 header-font">Currency</h3>
                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-3 text-center">
                        <div>
                            <label for="currency-pp" class="block text-xs font-medium text-[#93acc8]">Platinum (PP)</label>
                            <p id="currency-pp" class="text-lg text-[#e0e0e0] owner-edit-target-text">0</p>
                        </div>
                        <div>
                            <label for="currency-gp" class="block text-xs font-medium text-[#93acc8]">Gold (GP)</label>
                            <p id="currency-gp" class="text-lg text-[#e0e0e0] owner-edit-target-text">0</p>
                        </div>
                        <div>
                            <label for="currency-sp" class="block text-xs font-medium text-[#93acc8]">Silver (SP)</label>
                            <p id="currency-sp" class="text-lg text-[#e0e0e0] owner-edit-target-text">0</p>
                        </div>
                        <div>
                            <label for="currency-cp" class="block text-xs font-medium text-[#93acc8]">Copper (CP)</label>
                            <p id="currency-cp" class="text-lg text-[#e0e0e0] owner-edit-target-text">0</p>
                        </div>
                    </div>
                </div>

                <!-- Items -->
                <div class="content-card mb-4">
                    <h3 class="text-lg font-semibold text-[#e0e0e0] mb-2 header-font">Items</h3>
                    <div class="item-header-grid grid grid-cols-12 gap-x-2 items-center pb-1 mb-2 border-b-2 border-[#384d66] text-xs text-[#93acc8] font-semibold">
                        <span class="col-span-4">ITEM NAME</span>
                        <span class="col-span-1 text-center">QTY</span>
                        <span class="col-span-2 text-center">WEIGHT (EA)</span>
                        <span class="col-span-2 text-center">LOCATION</span>
                        <span class="col-span-1 text-center">EQUIPPED</span>
                        <span class="col-span-2 text-center">ACTIONS</span>
                    </div>
                    <ul id="inventory-items-list" class="space-y-2 text-sm">
                        <!-- JS will populate this -->
                        <!-- Example item structure:
                        <li class="inventory-item grid grid-cols-12 gap-x-2 items-center py-1.5 border-b border-[#243447]">
                            <div class="col-span-4">
                                <p class="font-semibold text-[#e0e0e0]">Longsword</p>
                                <p class="text-xs text-[#b0c4de]">Masterwork, sharp!</p>
                            </div>
                            <p class="col-span-1 text-center">1</p>
                            <p class="col-span-2 text-center">4 lbs</p>
                            <p class="col-span-2 text-center owner-edit-target-text">Sheath</p> 
                            <div class="col-span-1 text-center">
                                <input type="checkbox" class="inventory-item-equipped modal-checkbox owner-edit-target-input">
                            </div>
                            <div class="col-span-2 text-center space-x-1 owner-edit-block">
                                <button class="action-button-xs material-icons">edit</button>
                                <button class="action-button-xs destructive-btn-xs material-icons">delete</button>
                            </div>
                        </li>
                        -->
                    </ul>
                    <p id="no-inventory-items" class="text-[#93acc8] text-center py-3 hidden">No items in inventory.</p>
                </div>

                <!-- Encumbrance / Load -->
                <div class="content-card">
                    <h3 class="text-lg font-semibold text-[#e0e0e0] mb-2 header-font">Encumbrance</h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <p class="text-sm text-[#93acc8]">Total Weight Carried:</p>
                            <p id="total-weight-carried" class="text-xl font-bold text-[#e0e0e0]">0 lbs</p>
                        </div>
                        <div class="text-sm space-y-1">
                            <p><strong>Light Load:</strong> <span id="enc-light-load" class="text-[#93acc8]">Up to X lbs</span></p>
                            <p><strong>Medium Load:</strong> <span id="enc-medium-load" class="text-[#93acc8]">Up to Y lbs</span></p>
                            <p><strong>Heavy Load:</strong> <span id="enc-heavy-load" class="text-[#93acc8]">Up to Z lbs</span></p>
                            <p class="text-xs text-[#b0c4de] mt-1">(Penalties may apply for medium/heavy load)</p>
                        </div>
                    </div>
                </div>
            </section>

            <section class="px-4 pt-6 pb-2">
                <h2 class="text-[#e0e0e0] text-xl font-semibold tracking-tight mb-3 header-font">Capabilities</h2>
                <div class="content-card">
                    <div class="flex justify-between items-center mb-2">
                        <h3 class="text-lg font-semibold text-[#e0e0e0] header-font">Languages</h3>
                        <button id="add-language-btn" class="action-button action-button-sm owner-edit-btn">
                            <span class="material-icons">add</span> Add
                        </button>
                    </div>
                    <ul id="languages-list" class="list-disc list-inside text-[#b0c4de] text-sm space-y-1">

                    </ul>
                </div>
                <div class="content-card">
                     <div class="flex justify-between items-center mb-2">
                        <h3 class="text-lg font-semibold text-[#e0e0e0] header-font">Traits & Drawbacks</h3>
                        <button id="add-trait-btn" class="action-button action-button-sm owner-edit-btn">
                            <span class="material-icons">add</span> Add
                        </button>
                    </div>
                    <ul id="traits-drawbacks-list" class="list-disc list-inside text-[#b0c4de] text-sm space-y-1">

                    </ul>
                </div>
            </section>

            <section class="px-4 pt-6 pb-2 skills-section">
                <div class="flex justify-between items-center mb-3 skills-section-header cursor-pointer" id="skills-section-toggle">
                    <h2 class="text-[#e0e0e0] text-xl font-semibold tracking-tight header-font card-header-skill">
                        Skills <span class="material-icons skills-toggle-icon text-lg align-middle">expand_less</span>
                    </h2>
                    <button id="add-custom-skill-btn" class="action-button action-button-sm owner-edit-btn">
                        <span class="material-icons">add</span> Custom Skill
                    </button>
                </div>
                <div class="content-card skills-content" id="skills-content-area"> 
                    <div class="skill-item-header grid grid-cols-12 gap-x-2 items-center pb-1 mb-2 border-b-2 border-[#384d66] text-xs text-[#93acc8] font-semibold">
                        <span class="col-span-3">SKILL</span>
                        <span class="col-span-1 text-center" title="Selected Ability Score">ATTR</span>
                        <span class="col-span-1 text-center" title="Total Bonus">TOTAL</span>
                        <span class="col-span-1 text-center" title="Ability Modifier">MOD</span>
                        <span class="col-span-2 text-center">RANKS</span>
                        <span class="col-span-2 text-center">MISC</span>
                        <span class="col-span-1 text-center" title="Class Skill">CLASS</span>
                        <span class="col-span-1 text-center">DEL</span>
                    </div>
                    <div id="skills-list-container" class="text-sm space-y-1">
                    </div>
                </div>
            </section>

            <section id="spellcasting-section" class="px-4 pt-6 pb-4">
                <div class="flex justify-between items-center mb-3">
                    <h2 class="text-[#e0e0e0] text-xl font-semibold tracking-tight header-font card-header-mental">Spellcasting</h2>
                    <div class="flex items-center space-x-2">
                        <div id="spellcasting-enable-container" class="owner-edit-block hidden items-center">
                            <input type="checkbox" id="spellcasting-enabled-checkbox" class="h-4 w-4 text-[#1873dc] bg-[#0d1117] border-[#384d66] rounded focus:ring-[#1873dc] mr-2">
                            <label for="spellcasting-enabled-checkbox" class="text-sm text-[#93acc8]">Enable Spellcasting</label>
                        </div>
                        <button id="add-spell-btn" class="action-button action-button-sm owner-edit-btn">
                            <span class="material-icons">add</span> Add Spell
                        </button>
                    </div>
                </div>
                <div id="spellcasting-content-container" class="hidden">
                    <div class="content-card mb-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-3">
                            <div>
                                <label for="spell-caster-class" class="block text-xs font-medium text-[#93acc8] mb-1">Caster Class</label>
                                <p id="spell-caster-class" class="text-[#e0e0e0] owner-edit-target-text">(Class)</p>
                            </div>
                            <div>
                                <label for="spell-caster-level" class="block text-xs font-medium text-[#93acc8] mb-1">Caster Level</label>
                                <p id="spell-caster-level" class="text-[#e0e0e0] owner-edit-target-text">0</p>
                            </div>
                            <div>
                                <label for="spell-concentration" class="block text-xs font-medium text-[#93acc8] mb-1">Concentration</label>
                                <p id="spell-concentration" class="text-[#e0e0e0] owner-edit-target-text">+0</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-3">
                            <div>
                                <label for="spell-primary-casting-stat" class="block text-xs font-medium text-[#93acc8] mb-1">Primary Casting Stat</label>
                                <div id="spell-primary-casting-stat-container" class="owner-edit-block">
                                    <select id="spell-primary-casting-stat-select" class="modal-input w-full hidden owner-edit-target-input">
                                        <option value="INT">Intelligence</option>
                                        <option value="WIS">Wisdom</option>
                                        <option value="CHA">Charisma</option>
                                    </select>
                                    <p id="spell-primary-casting-stat-display" class="text-[#e0e0e0]">INT</p>
                                </div>
                            </div>
                            <div>
                                <label class="block text-xs font-medium text-[#93acc8] mb-1">Spell Save DC (Primary)</label>
                                <p id="spell-save-dc-primary" class="text-[#e0e0e0]">DC 10</p>
                            </div>
                        </div>
                    </div>

                    <div class="content-card mb-4">
                        <h4 class="text-md font-semibold text-[#c0c0c0] mb-2">Spells Per Day</h4>
                        <div id="spells-per-day-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-3">
                            <!-- JS will populate this for levels 0-9 -->
                            <!-- Example structure for one level (to be generated by JS):
                            <div class="spd-level-group" data-level="1">
                                <label class="block text-sm font-medium text-[#93acc8]">Level 1 Spells</label>
                                <div class="flex items-center space-x-2 mt-1">
                                    <input type="number" min="0" placeholder="Total" class="spd-input spd-total-input modal-input w-1/2 owner-edit-target-input" title="Total spells per day for this level">
                                    <span class="text-[#93acc8]">/</span>
                                    <input type="number" min="0" placeholder="Used" class="spd-input spd-used-input modal-input w-1/2 owner-edit-target-input" title="Spells used today for this level">
                                </div>
                            </div>
                             -->
                        </div>
                    </div>

                    <div class="content-card">
                        <h4 class="text-md font-semibold text-[#c0c0c0] mb-1">Spells Known</h4>
                        <ul id="spells-known-list" class="space-y-2 text-sm">
                            <!-- Populated by JS -->
                        </ul>
                    </div>
                </div>
            </section>
            
            <section id="bio-details-section" class="px-4 pt-6 pb-6">
                <h2 class="text-[#e0e0e0] text-xl font-semibold tracking-tight mb-3 header-font">Bio & Details</h2>
                <div class="content-card">
                    <h3 class="text-lg font-semibold text-[#e0e0e0] mb-1 header-font">Appearance</h3>
                    <div id="bio-appearance-text" class="scroll-like-container owner-edit-target">A rugged individual...</div>
                </div>
                <div class="content-card">
                    <h3 class="text-lg font-semibold text-[#e0e0e0] mb-1 header-font">Personality</h3>
                    <div id="bio-personality-text" class="scroll-like-container owner-edit-target">Stoic and observant...</div>
                </div>
                <div class="content-card">
                    <h3 class="text-lg font-semibold text-[#e0e0e0] mb-1 header-font">Background</h3>
                    <div id="bio-background-text" class="scroll-like-container owner-edit-target">Orphaned at a young age...</div>
                </div>
                <div class="content-card">
                    <h3 class="text-lg font-semibold text-[#e0e0e0] mb-1 header-font">Ideals</h3>
                    <div id="bio-ideals-text" class="scroll-like-container owner-edit-target"></div>
                </div>
                <div class="content-card">
                    <h3 class="text-lg font-semibold text-[#e0e0e0] mb-1 header-font">Bonds</h3>
                    <div id="bio-bonds-text" class="scroll-like-container owner-edit-target"></div>
                </div>
                <div class="content-card">
                    <h3 class="text-lg font-semibold text-[#e0e0e0] mb-1 header-font">Flaws</h3>
                    <div id="bio-flaws-text" class="scroll-like-container owner-edit-target"></div>
                </div>
                <div class="content-card">
                    <h3 class="text-lg font-semibold text-[#e0e0e0] mb-1 header-font">Allies & Organizations</h3>
                    <div id="bio-allies-orgs-text" class="scroll-like-container owner-edit-target"></div>
                </div>
                <div class="content-card">
                    <h3 class="text-lg font-semibold text-[#e0e0e0] mb-1 header-font">General Notes</h3>
                    <div id="bio-general-notes-text" class="scroll-like-container owner-edit-target"></div>
                </div>
            </section>
        </div> 

        <nav class="fixed bottom-0 left-0 right-0 bg-[#111922]/90 backdrop-blur-md border-t border-[#243447] shadow-top z-10">
            <div class="flex justify-around items-center px-2 pt-2 pb-safe-bottom">
                <a id="nav-overview-btn" class="flex flex-col items-center justify-center gap-1 text-[#1873dc] p-2 rounded-md w-1/5" href="#">
                    <span class="material-icons">home</span><span class="text-xs font-medium">Overview</span>
                </a>
                <a id="nav-combat-btn" class="flex flex-col items-center justify-center gap-1 text-[#93acc8] hover:text-[#1873dc] p-2 rounded-md w-1/5 transition-colors" href="#attacks-section">
                    <span class="material-icons">shield</span><span class="text-xs font-medium">Combat</span>
                </a>
                <a id="nav-inventory-btn" class="flex flex-col items-center justify-center gap-1 text-[#93acc8] hover:text-[#1873dc] p-2 rounded-md w-1/5 transition-colors" href="#inventory-section">
                    <span class="material-icons">inventory_2</span><span class="text-xs font-medium">Inventory</span>
                </a>
                <a id="nav-spells-btn" class="flex flex-col items-center justify-center gap-1 text-[#93acc8] hover:text-[#1873dc] p-2 rounded-md w-1/5 transition-colors" href="#spellcasting-section">
                    <span class="material-icons">menu_book</span><span class="text-xs font-medium">Spells</span>
                </a>
                <a id="nav-bio-btn" class="flex flex-col items-center justify-center gap-1 text-[#93acc8] hover:text-[#1873dc] p-2 rounded-md w-1/5 transition-colors" href="#bio-details-section">
                    <span class="material-icons">person</span><span class="text-xs font-medium">Bio</span>
                </a>
            </div>
            <div class="h-env-safe-area-bottom bg-[#111922]/90"></div>
        </nav>
    </div>

    <div id="global-message-container"></div>

    <div id="auth-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-xl font-bold mb-4">Login or Sign Up</h2>
            <div class="space-y-3 mb-4">
                <div>
                    <label for="email-input" class="block text-sm font-medium text-[#c0c0c0]">Email</label>
                    <input type="email" id="email-input" class="modal-input" placeholder="you@example.com">
                </div>
                <div>
                    <label for="password-input" class="block text-sm font-medium text-[#c0c0c0]">Password</label>
                    <input type="password" id="password-input" class="modal-input" placeholder="••••••••">
                </div>
            </div>
            <div id="auth-error-message" class="text-red-500 text-sm mb-3 hidden"></div>
            <div class="modal-actions flex flex-col sm:flex-row gap-2 mb-4">
                <button id="email-signin-btn" class="confirm-btn flex-1">Sign In</button>
                <button id="email-signup-btn" class="action-button-secondary flex-1">Sign Up</button>
            </div>
            <div class="relative flex py-3 items-center">
                <div class="flex-grow border-t border-[#243447]"></div>
                <span class="flex-shrink mx-4 text-[#93acc8] text-sm">Or continue with</span>
                <div class="flex-grow border-t border-[#243447]"></div>
            </div>
            <button id="google-signin-btn" class="w-full bg-white text-[#0d1117] border border-[#243447] hover:bg-gray-100 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center justify-center">
                <svg class="w-4 h-4 mr-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 18 19">
                    <path fill-rule="evenodd" d="M8.842 18.083a8.8 8.8 0 0 1-8.65-8.948 8.841 8.841 0 0 1 8.8-8.652h.153a8.464 8.464 0 0 1 5.7 2.257l-2.193 2.038A5.27 5.27 0 0 0 9.09 3.4a5.882 5.882 0 0 0-.2 11.76h.124a5.091 5.091 0 0 0 5.248-4.057L14.3 11H9V8h8.34c.066.543.095 1.09.088 1.636-.086 5.053-3.574 8.447-8.442 8.447H8.842Z" clip-rule="evenodd"/>
                </svg>
                Sign in with Google
            </button>
            <div class="modal-actions mt-6">
                <button id="auth-modal-close-btn" class="cancel-btn">Close</button>
            </div>
        </div>
    </div>

    <div id="settings-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-6 header-font">Sheet Settings</h2>
            
            <div class="space-y-4">
                <div>
                    <label class="flex items-center justify-between">
                        <span class="modal-label">Show Point Buy Button</span>
                        <input type="checkbox" id="setting-show-point-buy-btn" class="modal-checkbox h-5 w-5">
                    </label>
                    <p class="text-xs text-[#93acc8] mt-1">Toggles visibility of the Point Buy Calculator button on the sheet.</p>
                </div>

                <div>
                    <label for="setting-theme-select" class="modal-label">Theme (Visual Only - Placeholder)</label>
                    <select id="setting-theme-select" class="modal-input">
                        <option value="dark">Dark Theme (Default)</option>
                        <option value="light" disabled>Light Theme (Coming Soon)</option>
                        <option value="sepia" disabled>Sepia Tone (Coming Soon)</option>
                    </select>
                </div>
                
                <!-- Add more settings here as needed -->

            </div>

            <div id="settings-modal-message" class="text-green-400 text-sm mt-4 mb-2 hidden">Settings saved.</div>

            <div class="modal-actions mt-8">
                <button id="settings-modal-save-btn" class="confirm-btn">Save & Close</button>
                <button id="settings-modal-close-btn" class="cancel-btn">Close</button>
            </div>
        </div>
    </div>

    {/* Sheets Manager Modal */}
    <div id="sheets-manager-modal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 600px;">
            <h2 class="text-xl font-bold mb-4">My Character Sheets</h2>
            <div id="sheets-list-container" class="mb-4" style="max-height: 300px; overflow-y: auto;">
                {/* Sheet items will be populated here by JS */}
                {/* Example item structure:
                <div class="flex justify-between items-center p-2 border-b border-[#243447]">
                    <span class="sheet-name">Sheet Name</span>
                    <div class="space-x-2">
                        <button class="action-button-sm open-sheet-btn" data-sheet-id="SHEET_ID_HERE">Open</button>
                        <button class="action-button-sm cancel-btn delete-sheet-btn" data-sheet-id="SHEET_ID_HERE">Delete</button>
                    </div>
                </div>
                */}
            </div>
             <div id="no-sheets-message" class="text-center text-[#93acc8] mb-4 hidden">
                You don't have any character sheets yet.
            </div>
            <div class="modal-actions flex-col sm:flex-row">
                <button id="create-new-sheet-btn" class="confirm-btn flex-1 order-first sm:order-last">Create New Sheet</button>
                <button id="sheets-manager-close-btn" class="cancel-btn flex-1">Close</button>
            </div>
        </div>
    </div>

    <div id="alignment-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 class="text-xl font-bold mb-4">Select Alignment</h2>
            <div class="grid grid-cols-3 gap-2 mb-4">
                <button class="alignment-select-btn alignment-grid-button action-button-secondary" data-alignment="Lawful Good">Lawful Good</button>
                <button class="alignment-select-btn alignment-grid-button action-button-secondary" data-alignment="Neutral Good">Neutral Good</button>
                <button class="alignment-select-btn alignment-grid-button action-button-secondary" data-alignment="Chaotic Good">Chaotic Good</button>
                <button class="alignment-select-btn alignment-grid-button action-button-secondary" data-alignment="Lawful Neutral">Lawful Neutral</button>
                <button class="alignment-select-btn alignment-grid-button action-button-secondary" data-alignment="Neutral">Neutral</button>
                <button class="alignment-select-btn alignment-grid-button action-button-secondary" data-alignment="Chaotic Neutral">Chaotic Neutral</button>
                <button class="alignment-select-btn alignment-grid-button action-button-secondary" data-alignment="Lawful Evil">Lawful Evil</button>
                <button class="alignment-select-btn alignment-grid-button action-button-secondary" data-alignment="Neutral Evil">Neutral Evil</button>
                <button class="alignment-select-btn alignment-grid-button action-button-secondary" data-alignment="Chaotic Evil">Chaotic Evil</button>
            </div>
            <div class="relative flex py-3 items-center">
                <div class="flex-grow border-t border-[#243447]"></div>
                <span class="flex-shrink mx-4 text-[#93acc8] text-sm">Or specify custom</span>
                <div class="flex-grow border-t border-[#243447]"></div>
            </div>
            <div class="flex gap-2 mb-4">
                <input type="text" id="custom-alignment-input" class="modal-input flex-grow" placeholder="Custom Alignment">
                <button id="save-custom-alignment-btn" class="confirm-btn">Save Custom</button>
            </div>
            <div class="modal-actions">
                <button id="alignment-modal-close-btn" class="cancel-btn">Close</button>
            </div>
        </div>
    </div>

    <!-- Spell Detail Modal -->
    <div id="spell-detail-modal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 700px;">
            <h2 id="spell-modal-title" class="text-2xl font-bold mb-4 header-font">Spell Details</h2>
            <input type="hidden" id="spell-modal-id">
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-3">
                <div>
                    <label for="spell-modal-name" class="modal-label">Name</label>
                    <input type="text" id="spell-modal-name" class="modal-input">
                </div>
                <div>
                    <label for="spell-modal-level" class="modal-label">Level (0-9)</label>
                    <input type="number" id="spell-modal-level" min="0" max="9" class="modal-input">
                </div>
                <div>
                    <label for="spell-modal-school" class="modal-label">School</label>
                    <input type="text" id="spell-modal-school" class="modal-input">
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-3">
                <div>
                    <label for="spell-modal-casting-time" class="modal-label">Casting Time</label>
                    <input type="text" id="spell-modal-casting-time" class="modal-input">
                </div>
                <div>
                    <label for="spell-modal-range" class="modal-label">Range</label>
                    <input type="text" id="spell-modal-range" class="modal-input">
                </div>
            </div>

            <div class="mb-3">
                <label class="modal-label mb-1">Components</label>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-2 items-center">
                    <label class="flex items-center space-x-1.5"><input type="checkbox" id="spell-modal-comp-v" class="modal-checkbox"><span>V</span></label>
                    <label class="flex items-center space-x-1.5"><input type="checkbox" id="spell-modal-comp-s" class="modal-checkbox"><span>S</span></label>
                    <label class="flex items-center space-x-1.5"><input type="checkbox" id="spell-modal-comp-m" class="modal-checkbox"><span>M</span></label>
                    <label class="flex items-center space-x-1.5"><input type="checkbox" id="spell-modal-comp-f" class="modal-checkbox"><span>F</span></label>
                    <label class="flex items-center space-x-1.5"><input type="checkbox" id="spell-modal-comp-df" class="modal-checkbox"><span>DF</span></label>
                    <label class="flex items-center space-x-1.5"><input type="checkbox" id="spell-modal-comp-xp" class="modal-checkbox"><span>XP</span></label>
                </div>
                <div class="mt-2">
                    <label for="spell-modal-material-cost" class="modal-label text-xs">Material Components/Focus/XP Cost Details</label>
                    <input type="text" id="spell-modal-material-cost" class="modal-input text-sm" placeholder="e.g., a pinch of sulfur, or an owl feather costing 10gp">
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-3">
                <div>
                    <label for="spell-modal-duration" class="modal-label">Duration</label>
                    <input type="text" id="spell-modal-duration" class="modal-input">
                </div>
                <div>
                    <label for="spell-modal-saving-throw" class="modal-label">Saving Throw</label>
                    <input type="text" id="spell-modal-saving-throw" class="modal-input" placeholder="e.g., Will negates">
                </div>
                <div>
                    <label for="spell-modal-spell-resistance" class="modal-label">Spell Resistance</label>
                    <input type="text" id="spell-modal-spell-resistance" class="modal-input" placeholder="e.g., Yes (harmless)">
                </div>
            </div>

            <div class="mb-4">
                <label for="spell-modal-description" class="modal-label">Description</label>
                <textarea id="spell-modal-description" rows="4" class="modal-input"></textarea>
            </div>

            <div id="spell-modal-prepared-uses-container" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                 <div>
                    <label for="spell-modal-prepared" class="modal-label">Prepared Count</label>
                    <input type="number" id="spell-modal-prepared" min="0" class="modal-input">
                </div>
                <div>
                    <label for="spell-modal-uses" class="modal-label">Uses/Day</label>
                    <input type="number" id="spell-modal-uses" min="0" class="modal-input">
                </div>
            </div>

            <div id="spell-modal-error-message" class="text-red-500 text-sm mb-3 hidden"></div>

            <div class="modal-actions">
                <button id="spell-modal-save-btn" class="confirm-btn">Save Spell</button>
                <button id="spell-modal-close-btn" class="cancel-btn">Close</button>
            </div>
        </div>
    </div>

    <!-- Point Buy Calculator Modal -->
    <div id="point-buy-modal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 800px;">
            <h2 class="text-2xl font-bold mb-4 header-font">Point Buy Calculator</h2>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-4">
                <div>
                    <label for="point-buy-total-points" class="modal-label">Total Points:</label>
                    <select id="point-buy-total-points" class="modal-input">
                        <option value="10">10 Points (Low Fantasy)</option>
                        <option value="15">15 Points (Standard Fantasy)</option>
                        <option value="20">20 Points (High Fantasy)</option>
                        <option value="25">25 Points (Epic Fantasy)</option>
                        <option value="custom">Custom</option>
                    </select>
                    <input type="number" id="point-buy-custom-total" class="modal-input mt-2 hidden" placeholder="Enter custom total">
                </div>
                <div>
                    <label class="modal-label">Points Remaining:</label>
                    <p id="point-buy-remaining" class="text-2xl font-bold text-sky-400">15</p>
                </div>
            </div>

            <div id="point-buy-attributes-container" class="space-y-3 mb-6">
                <!-- Attribute rows will be generated by JS here -->
                <!-- Example Row Structure (NEW - with inline racial mod):
                <div class="pb-attr-row grid grid-cols-7 items-center gap-2 p-2 bg-[#1a2532] rounded-md">
                    <label class="col-span-1 modal-label text-sm font-semibold">STR</label>
                    <button class="pb-btn pb-decrease material-icons action-button-xs">remove</button>
                    <input type="number" readonly class="pb-score-display modal-input w-12 text-center bg-[#0d1117]">
                    <button class="pb-btn pb-increase material-icons action-button-xs">add</button>
                    <input type="number" class="racial-mod-inline-input modal-input w-12 text-center" value="0" title="Racial Modifier">
                    <p class="pb-cost text-xs text-right text-[#93acc8] col-span-1">Cost: 0</p> // Adjusted cost to col-span-1
                    <p class="pb-final-inline text-sm text-center text-sky-400 col-span-1">Final: 10</p> // New final score display
                </div>
                -->
            </div>
            
            <div id="point-buy-error-message" class="text-red-500 text-sm mb-3 hidden"></div>

            <div class="modal-actions">
                <button id="point-buy-apply-btn" class="confirm-btn">Apply to Sheet</button>
                <button id="point-buy-reset-btn" class="action-button-secondary">Reset Calculator</button>
                <button id="point-buy-close-btn" class="cancel-btn">Close</button>
            </div>
        </div>
    </div>

    <!-- Item Detail Modal -->
    <div id="item-detail-modal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 550px;">
            <h2 id="item-modal-title" class="text-2xl font-bold mb-4 header-font">Item Details</h2>
            <input type="hidden" id="item-modal-id">
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-3">
                <div>
                    <label for="item-modal-name" class="modal-label">Name</label>
                    <input type="text" id="item-modal-name" class="modal-input">
                </div>
                <div>
                    <label for="item-modal-quantity" class="modal-label">Quantity</label>
                    <input type="number" id="item-modal-quantity" min="0" value="1" class="modal-input">
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-3">
                 <div>
                    <label for="item-modal-weight" class="modal-label">Weight (each, in lbs)</label>
                    <input type="number" id="item-modal-weight" min="0" step="0.1" value="0" class="modal-input">
                </div>
                <div>
                    <label for="item-modal-location" class="modal-label">Location / Container</label>
                    <input type="text" id="item-modal-location" class="modal-input" placeholder="e.g., Backpack, Belt Pouch">
                </div>
            </div>

            <div class="mb-3">
                <label for="item-modal-notes" class="modal-label">Notes / Description</label>
                <textarea id="item-modal-notes" rows="3" class="modal-input"></textarea>
            </div>

            <div class="mb-4">
                <label class="flex items-center space-x-2">
                    <input type="checkbox" id="item-modal-equipped" class="modal-checkbox">
                    <span>Equipped / Worn</span>
                </label>
            </div>
            
            <div id="item-modal-error-message" class="text-red-500 text-sm mb-3 hidden"></div>

            <div class="modal-actions">
                <button id="item-modal-save-btn" class="confirm-btn">Save Item</button>
                <button id="item-modal-close-btn" class="cancel-btn">Close</button>
            </div>
        </div>
    </div>

    <!-- Attack Detail Modal -->
    <div id="attack-detail-modal" class="modal-overlay hidden">
        <div class="modal-content" style="max-width: 650px;">
            <h2 id="attack-modal-title" class="text-2xl font-bold mb-4 header-font">Attack Details</h2>
            <input type="hidden" id="attack-modal-id">
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-3">
                <div>
                    <label for="attack-modal-name" class="modal-label">Weapon/Action Name</label>
                    <input type="text" id="attack-modal-name" class="modal-input">
                </div>
                <div>
                    <label for="attack-modal-type" class="modal-label">Type (e.g., Melee, Ranged, Slashing)</label>
                    <input type="text" id="attack-modal-type" class="modal-input" placeholder="Melee, Slashing">
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-3">
                <div>
                    <label for="attack-modal-bonus" class="modal-label">Attack Bonus(es)</label>
                    <input type="text" id="attack-modal-bonus" class="modal-input" placeholder="+7 or +7/+2">
                </div>
                 <div>
                    <label for="attack-modal-damage" class="modal-label">Damage</label>
                    <input type="text" id="attack-modal-damage" class="modal-input" placeholder="1d8+3">
                </div>
                <div>
                    <label for="attack-modal-critical" class="modal-label">Critical</label>
                    <input type="text" id="attack-modal-critical" class="modal-input" placeholder="19-20/x2 or x3">
                </div>
            </div>
            
            <div class="mb-3">
                <label for="attack-modal-range" class="modal-label">Range (if applicable)</label>
                <input type="text" id="attack-modal-range" class="modal-input" placeholder="e.g., 5ft, 60ft, Touch">
            </div>

            <div class="mb-4">
                <label for="attack-modal-notes" class="modal-label">Notes (e.g., properties, special effects)</label>
                <textarea id="attack-modal-notes" rows="3" class="modal-input"></textarea>
            </div>
            
            <div id="attack-modal-error-message" class="text-red-500 text-sm mb-3 hidden"></div>

            <div class="modal-actions">
                <button id="attack-modal-save-btn" class="confirm-btn">Save Attack</button>
                <button id="attack-modal-close-btn" class="cancel-btn">Close</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
      import { getAuth } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
      import { getFirestore } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
      import { getStorage } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries

      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyBee15I1hpHP8MKwFO1-ew7qr6tYk4ng7Q",
        authDomain: "pathforge-10e42.firebaseapp.com",
        databaseURL: "https://pathforge-10e42-default-rtdb.firebaseio.com",
        projectId: "pathforge-10e42",
        storageBucket: "pathforge-10e42.firebasestorage.app",
        messagingSenderId: "451081749017",
        appId: "1:451081749017:web:c8e1b8076e4107eb8fa088",
        measurementId: "G-4WT17TPMG8"
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const firestore = getFirestore(app);
      const storage = getStorage(app);

      // You can make these available globally for easier access in character-sheet.js
      // or pass them to functions as needed.
      window.firebaseApp = app;
      window.firebaseAuth = auth;
      window.firebaseFirestore = firestore;
      window.firebaseStorage = storage;

    </script>

    <script type="module" src="character-sheet.js" defer></script>
</body>
</html>
